install.packages("car")
library(knitr)
opts_chunk$set(
message = FALSE,
warning = FALSE,
cache = FALSE,
echo=FALSE,
fig.height = 2,
fig.width = 5,
collapse = TRUE,
comment = "#>"
)
options(digits=2)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(gridExtra)
library(xkcd)
olympics2016 <- read_csv("../data/olympics2016.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2016 <- read_csv("../data/olympics2016.csv")
?full_join
oly <- full_join(olympics2016[,c("Country","Total")],
olympics2012[,c("Country","Total")], by="Country",
all.x=TRUE)
View(oly)
olympics2012 <- read_csv("../data/olympics2012.csv")
olympics2016 <- read_csv("../data/olympics2016.csv")
oly <- full_join(olympics2016[,c("Country","Total")],
olympics2012[,c("Country","Total")], by="Country",
all.x=TRUE)
colnames(oly)[2] <- "M2016"
colnames(oly)[3] <- "M2012"
oly <- oly %>% replace_na(M20016=0, M2012=0)
olympics2012 <- read_csv("../data/olympics2012.csv")
olympics2016 <- read_csv("../data/olympics2016.csv")
oly <- full_join(olympics2016[,c("Country","Total")],
olympics2012[,c("Country","Total")], by="Country",
all.x=TRUE)
colnames(oly)[2] <- "M2016"
colnames(oly)[3] <- "M2012"
oly <- oly %>% replace_na(M20016=0, M2012=0)
?replace_na
oly <- oly %>% replace_na(list(M20016=0, M2012=0))
olympics2012 <- read_csv("../data/olympics2012.csv")
olympics2016 <- read_csv("../data/olympics2016.csv")
oly <- full_join(olympics2016[,c("Country","Total")],
olympics2012[,c("Country","Total")], by="Country",
all.x=TRUE)
colnames(oly)[2] <- "M2016"
colnames(oly)[3] <- "M2012"
oly <- oly %>% replace_na(list(M20016=0, M2012=0))
oly <- oly %>% replace_na(list(M2016=0, M2012=0))
oly_lm <- glm(M2016~M2012, data=oly)
library(broom)
tidy(oly_lm)
coefs <- tidy(oly_lm)
ggplot(oly, aes(x=M2012, y=M2016)) + geom_point() +
geom_smooth(method="lm", se=FALSE) + theme_xkcd() + xkcdaxis(c(0,110),c(0,110))
plotly()
ggplotly()
library(plotly)
ggplotly()
?ggplotly
ggplot(oly, aes(x=M2012, y=M2016, text=Country)) + geom_point() +
geom_smooth(method="lm", se=FALSE) + theme_xkcd() + xkcdaxis(c(0,110),c(0,110))
head(oly)
ggplot(oly, aes(x=M2012, y=M2016)) +
geom_point(aes(text=Country)) +
geom_smooth(method="lm", se=FALSE) + theme_xkcd() + xkcdaxis(c(0,110),c(0,110))
ggplotly()
ggplot(oly, aes(x=M2012, y=M2016)) +
geom_point(aes(text=Country)) +
geom_smooth(method="lm", se=FALSE) + theme_xkcd() + xkcdaxis(c(0,125),c(0,125))
library(plotly)
ggplotly()
coefs_noUSA <- tidy(oly_noUSA_lm)
oly_noUSA <- oly %>% filter(Country != "UnitedStates")
oly_noUSA_lm <- glm(M2016~M2012, data=oly_noUSA)
coefs_noUSA <- tidy(oly_noUSA_lm)
comp_estimates <- data.frame(all=coefs$estimate,
noUSA=coefs_noUSA$estimate)
comp_estimates$estimate <- c("intercept", "slope")
comp_estimates
oly_tf <- oly
oly_tf$M2012 <- log10(oly_tf$M2012+1)
oly_tf$M2016 <- log10(oly_tf$M2016+1)
ggplot(oly_tf, aes(x=M2012, y=M2016)) + geom_point() +
xlab("Log counts 2012") + ylab("Log counts 2016") +
theme_xkcd() + xkcdaxis(c(0,2.2),c(0,2.2))
oly_tf_lm <- glm(M2016~M2012, data=oly_tf)
oly_tf_diag <- augment(oly_tf_lm)
oly_tf_diag$Country <- oly$Country
oly_tf_diag %>% arrange(desc(.hat)) %>% select(Country, .hat) %>% head(15)
ggplot(oly_tf_diag, aes(x=.hat)) + geom_histogram() +
geom_vline(xintercept=0.027, colour="red") +
theme_xkcd() + xkcdaxis(c(0,.10),c(0,25))
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- merge(oly_gdp2016, olympics2012[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[7] <- "Total_2012"
oly_gdp_2016_2012[is.na(oly_gdp_2016_2012$Total_2012), "Total_2012"] <- 0
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- merge(oly_gdp2016, olympics2012[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[7] <- "Total_2012"
oly_gdp_2016_2012[is.na(oly_gdp_2016_2012$Total_2012), "Total_2012"] <- 0
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
library(GGally)
ggscatmat(oly_gdp2012, columns=13:15)
ggscatmat(oly_gdp_2016_2012, columns=13:15)
oly_gdp_2016_2012
ggscatmat(oly_gdp_2016_2012, columns=c(2,3,7))
ggscatmat(oly_gdp_2016_2012, columns=c(3,4,7))
ggscatmat(oly_gdp_2016_2012, columns=c(7,3,4))
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(gridExtra)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- merge(oly_gdp2016, olympics2012[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[7] <- "Total_2012"
oly_gdp_2016_2012[is.na(oly_gdp_2016_2012$Total_2012), "Total_2012"] <- 0
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Total_2012, y=Total_2016)) +
geom_point()
p2 <- ggplot(oly_gdp_2016_2012, aes(x=Population_mil, y=Total_2016)) +
geom_point()
p3 <- ggplot(oly_gdp_2016_2012, aes(x=GDP_PPP_bil, y=Total_2016)) +
geom_point()
grid.arrange(p1, p2, p3, ncol=3)
p1 <- ggplot(oly_gdp_2016_2012, aes(x=M2012, y=Pop_std, label=Country)) + geom_point()
library(plotly)
ggplotly(p1)
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Total_2012, y=Population_mil, label=Country)) + geom_point()
ggplotly(p1)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- merge(oly_gdp2016, olympics2012[,c("Country","Total")],
by="Country", all.x=TRUE)
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[7] <- "Total_2012"
oly_gdp_2016_2012[is.na(oly_gdp_2016_2012$Total_2012), "Total_2012"] <- 0
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
ggscatmat(oly_gdp_2016_2012, columns=c(7,3,4))
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Total_2012, y=Population_mil, label=Country)) + geom_point()
ggplotly(p1)
View(oly_gdp_2016_2012)
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Population_mil, y=Total_2012,  label=Country)) + geom_point()
library(plotly)
ggplotly(p1)
vif(oly_lm)
library(car)
vif(oly_lm)
olympics2008 <- read_csv("../data/olympics2008.csv")
View(olympics2008)
oly_gdp2016_12_08 <- full_join(oly_gdp2016,
olympics2008[,c("Country","Total")],
by="Coountry")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012,
olympics2008[,c("Country","Total")],
by="Coountry")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012,
olympics2008[,c("Country","Total")],
by="Coountry")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012,
olympics2008[,c("Country","Total")],
by="Country")
oly_gdp_2016_12_08
olympics2008 <- read_csv("../data/olympics2008.csv")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012[,-c("Medals_pmp", Medals_p100BGDP)],
olympics2008[,c("Country","Total")],
by="Country")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012[,-c("Medals_pmp", "Medals_p100BGDP")],
olympics2008[,c("Country","Total")],
by="Country")
olympics2008 <- read_csv("../data/olympics2008.csv")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012[,-c("Medals_pmp", "Medals_p100BGDP")],
olympics2008[,c("Country","Total")],
by="Country")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012[,c(1:4,7))],
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012[,c(1:4,7)],
olympics2008[,c("Country","Total")],
by="Country")
oly_gdp_2016_12_08
colnames(oly_gdp_2016_12_08)[6] <- "Total_2008"
ggplot(oly_gdp_2016_12_08, aes(x=M2008, y=M2016)) + geom_point() +
theme_xkcd() + xkcdaxis(c(0,110),c(0,110))
ggplot(oly_gdp_2016_12_08, aes(x=Total.2008, y=Total.2016)) + geom_point() +
theme_xkcd() + xkcdaxis(c(0,110),c(0,110))
ggplot(oly_gdp_2016_12_08, aes(x=Total_2008, y=Total_2016)) + geom_point() +
theme_xkcd() + xkcdaxis(c(0,110),c(0,110))
ggplot(oly_gdp_2016_12_08, aes(x=Total_2008, y=Total_2016)) + geom_point() +
theme_xkcd() + xkcdaxis(c(0,125),c(0,125))
View(oly_gdp_2016_12_08)
View(oly_gdp2016)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
problems()
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
?read_csv
oly_gdp2016 <- read_csv("../data/gdp2016.csv", n_max=20)
View(oly_gdp2016)
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
View(oly_gdp2016)
oly_gdp_2016_2012 <- merge(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country", all.x=TRUE)
View(oly_gdp_2016_12_08)
View(oly_gdp_2016_2012)
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- full_join(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country")
View(olympics2012)
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- full_join(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[5] <- "Total_2012"
0
oly_gdp_2016_2012 <- oly_gdp_2016_2012 %>%
replace_na(list(Total_2016=0, Total_2012=0))
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- full_join(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[5] <- "Total_2012"
oly_gdp_2016_2012 <- oly_gdp_2016_2012 %>%
replace_na(list(Total_2016=0, Total_2012=0))
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- full_join(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[5] <- "Total_2012"
oly_gdp_2016_2012 <- oly_gdp_2016_2012 %>%
replace_na(list(Total_2016=0, Total_2012=0))
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Total_2012, y=Total_2016)) +
geom_point()
p2 <- ggplot(oly_gdp_2016_2012, aes(x=Population_mil, y=Total_2016)) +
geom_point()
p3 <- ggplot(oly_gdp_2016_2012, aes(x=GDP_PPP_bil, y=Total_2016)) +
geom_point()
grid.arrange(p1, p2, p3, ncol=3)
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
library(broom)
tidy(oly_lm)
glance(oly_lm)
oly_diag <- augment(oly_lm)
oly_diag$Country <- oly_gdp2016$Country
p1 <- ggplot(oly_diag, aes(x=.fitted, y=Total_2016,
label=Country)) +
geom_point() + ylab("Observed Count") + xlab("Fitted") +
theme(aspect.ratio=1)
oly_diag <- augment(oly_lm)
View(oly_diag)
oly_gdp2016$Country
rownames(oly_gdp_2016_2012) <- oly_gdp_2016_2012$Country
oly_gdp_2016_2012
oly_diag$Country <- oly_gdp2016$Country[-53]
p1 <- ggplot(oly_diag, aes(x=.fitted, y=Total_2016,
label=Country)) +
geom_point() + ylab("Observed Count") + xlab("Fitted") +
theme(aspect.ratio=1)
p2 <- ggplot(oly_diag, aes(x=.fitted, y=.resid, label=Country)) + geom_point() + ylab("Residuals") + xlab("Fitted") +
theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
library(plotly)
ggplotly(p2)
p1 <- ggplot(oly_diag, aes(x=.fitted, y=Total_2016,
label=Country)) +
geom_point() + ylab("Observed Count") + xlab("Fitted") +
theme(aspect.ratio=1)
ggplotly(p1)
ggscatmat(oly_gdp_2016_2012, columns=c(5,3,4))
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- full_join(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[5] <- "Total_2012"
oly_gdp_2016_2012 <- oly_gdp_2016_2012 %>%
replace_na(list(Total_2016=0, Total_2012=0))
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
ggscatmat(oly_gdp_2016_2012, columns=c(5,3,4))
ggscatmat(oly_gdp_2016_2012)
ggscatmat(data.frame(oly_gdp_2016_2012))
ggscatmat(data.frame(oly_gdp_2016_2012), columns=c(5,3,4))
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Population_mil, y=Total_2012,
label=Country)) + geom_point()
library(plotly)
ggplotly(p1)
library(car)
vif(oly_lm)
olympics2008 <- read_csv("../data/olympics2008.csv")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012[,c(1:4,7)],
olympics2008[,c("Country","Total")],
by="Country")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012,
olympics2008[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_12_08)[6] <- "Total_2008"
ggplot(oly_gdp_2016_12_08, aes(x=Total_2008, y=Total_2016)) + geom_point() +
theme_xkcd() + xkcdaxis(c(0,125),c(0,125))
oly_lm <- glm(Total_2016~Total_2012+Total_2008+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_12_08)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm))
tidy(oly_lm)
vif(oly_lm)
?print
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(gridExtra)
library(xkcd)
#olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
olympics2016 <- read_csv("../data/olympics2016.csv")
oly <- full_join(olympics2016[,c("Country","Total")],
olympics2012[,c("Country","Total")], by="Country",
all.x=TRUE)
colnames(oly)[2] <- "M2016"
colnames(oly)[3] <- "M2012"
oly <- oly %>% replace_na(list(M2016=0, M2012=0))
oly_lm <- glm(M2016~M2012, data=oly)
library(broom)
tidy(oly_lm)
coefs <- tidy(oly_lm)
library(plotly)
p <- ggplot(oly, aes(x=M2012, y=M2016)) +
geom_point(aes(text=Country)) +
geom_smooth(method="lm", se=FALSE) + theme_xkcd() + xkcdaxis(c(0,140),c(0,140))
ggplotly(p)
library(knitr)
opts_chunk$set(
message = FALSE,
warning = FALSE,
cache = FALSE,
echo=FALSE,
fig.height = 2,
fig.width = 5,
collapse = TRUE,
comment = "#>"
)
options(digits=2)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(gridExtra)
library(xkcd)
#olympics2008 <- read_csv("../data/olympics2008.csv")
olympics2012 <- read_csv("../data/olympics2012.csv")
olympics2016 <- read_csv("../data/olympics2016.csv")
oly <- full_join(olympics2016[,c("Country","Total")],
olympics2012[,c("Country","Total")], by="Country",
all.x=TRUE)
colnames(oly)[2] <- "M2016"
colnames(oly)[3] <- "M2012"
oly <- oly %>% replace_na(list(M2016=0, M2012=0))
oly_lm <- glm(M2016~M2012, data=oly)
library(broom)
tidy(oly_lm)
coefs <- tidy(oly_lm)
library(plotly)
p <- ggplot(oly, aes(x=M2012, y=M2016)) +
geom_point(aes(text=Country)) +
geom_smooth(method="lm", se=FALSE) + theme_xkcd() + xkcdaxis(c(0,140),c(0,140))
ggplotly(p)
oly_noUSA <- oly %>% filter(Country != "UnitedStates")
oly_noUSA_lm <- glm(M2016~M2012, data=oly_noUSA)
coefs_noUSA <- tidy(oly_noUSA_lm)
comp_estimates <- data.frame(all=coefs$estimate,
noUSA=coefs_noUSA$estimate)
comp_estimates$estimate <- c("intercept", "slope")
comp_estimates
comp_estimates_m <- comp_estimates %>%
gather(model, stat, -estimate) %>%
spread(estimate, stat)
ggplot(oly, aes(x=M2012, y=M2016)) + geom_point() +
geom_abline(data=comp_estimates_m,
aes(intercept=intercept, slope=slope, colour=model))  + theme_xkcd() + xkcdaxis(c(0,125),c(0,125)) +
scale_color_brewer(palette="Dark2")
comp_diag <- data.frame(
null.dev=c(glance(oly_lm)$null.deviance, glance(oly_noUSA_lm)$null.deviance),
deviance=c(glance(oly_lm)$deviance, glance(oly_noUSA_lm)$deviance),
fitted=c(predict(oly_lm, oly[oly$Country=="UnitedStates",]),
predict(oly_noUSA_lm, oly[oly$Country=="UnitedStates",])),
resid=c(oly$M2012[oly$Country=="UnitedStates"]-
predict(oly_lm, oly[oly$Country=="UnitedStates",]),
oly$M2012[oly$Country=="UnitedStates"]-
predict(oly_noUSA_lm, oly[oly$Country=="UnitedStates",])))
rownames(comp_diag) <- c("All", "No USA")
kable(comp_diag, format="markdown", row.names=TRUE)
set.seed(2468)
df <- data.frame(x=c(runif(99), 10))
df$y <- df$x+c(rnorm(99), 6)
df_all <- glm(y~x, data=df)
df_no <- glm(y~x, data=df[-100,])
df_est <- data.frame(all=tidy(df_all)$estimate,
no=tidy(df_no)$estimate)
df_est$estimate <- c("intercept", "slope")
df_est_m <- df_est %>%
gather(model, stat, -estimate) %>%
spread(estimate, stat)
ggplot(df, aes(x=x, y=y)) + geom_point() +
geom_abline(data=df_est_m,
aes(intercept=intercept, slope=slope, colour=model))  + theme_xkcd() + xkcdaxis(c(0,10),c(0,16)) +
scale_color_brewer(palette="Dark2")
oly_diag <- augment(oly_lm)
oly_diag$Country <- oly$Country
oly_diag %>% arrange(desc(.hat)) %>% select(Country, .hat) %>% head(15)
ggplot(oly_diag, aes(x=.hat)) + geom_histogram() +
geom_vline(xintercept=0.027, colour="red") +
theme_xkcd() + xkcdaxis(c(0,0.33),c(0,40))
oly_tf <- oly
oly_tf$M2012 <- log10(oly_tf$M2012+1)
oly_tf$M2016 <- log10(oly_tf$M2016+1)
ggplot(oly_tf, aes(x=M2012, y=M2016)) + geom_point() +
xlab("Log counts 2012") + ylab("Log counts 2016") +
theme_xkcd() + xkcdaxis(c(0,2.2),c(0,2.2))
oly_tf_lm <- glm(M2016~M2012, data=oly_tf)
oly_tf_diag <- augment(oly_tf_lm)
oly_tf_diag$Country <- oly$Country
oly_tf_diag %>% arrange(desc(.hat)) %>% select(Country, .hat) %>% head(15)
ggplot(oly_tf_diag, aes(x=.hat)) + geom_histogram() +
geom_vline(xintercept=0.027, colour="red") +
theme_xkcd() + xkcdaxis(c(0,.10),c(0,25))
df_lm <- glm(y~x, data=df)
df_diag <- augment(df_lm)
ggplot(df_diag, aes(x=.hat)) + geom_histogram() +
geom_vline(xintercept=0.02, colour="red") +
theme_xkcd() + xkcdaxis(c(0,1),c(0,100))
tbl1 <- oly_diag %>% arrange(desc(.cooksd)) %>% select(Country, .cooksd)
tbl2 <- oly_tf_diag %>% arrange(desc(.cooksd)) %>% select(Country, .cooksd)
tbl <- cbind(tbl1, tbl2)
tbl
p1 <- ggplot(oly_diag, aes(x=.cooksd)) + geom_density(fill="black", alpha=0.5) +
theme_xkcd() + xkcdaxis(c(0,0.9),c(0,200))
p2 <- ggplot(oly_tf_diag, aes(x=.cooksd)) + geom_density(fill="black", alpha=0.5) +
theme_xkcd()+ xkcdaxis(c(0,0.5),c(0,70))
grid.arrange(p1, p2, ncol=2)
p1 <- ggplot(df_diag, aes(x=.cooksd)) + geom_density(fill="black", alpha=0.5) +
ggtitle("All cases") + theme_xkcd() + xkcdaxis(c(0,30),c(0,140))
df_lm <- glm(y~x, data=df[-100,])
df_diag <- augment(df_lm)
p2 <- ggplot(df_diag, aes(x=.cooksd)) + geom_density(fill="black", alpha=0.5) + ggtitle("Without the outlier") + theme_xkcd() +
xkcdaxis(c(0,0.2),c(0,80))
grid.arrange(p1, p2, ncol=2)
olympics2012 <- read_csv("../data/olympics2012.csv")
oly_gdp2016 <- read_csv("../data/gdp2016.csv")
oly_gdp_2016_2012 <- full_join(oly_gdp2016[,c(1,5,6,7)],
olympics2012[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_2012)[2] <- "Total_2016"
colnames(oly_gdp_2016_2012)[5] <- "Total_2012"
oly_gdp_2016_2012 <- oly_gdp_2016_2012 %>%
replace_na(list(Total_2016=0, Total_2012=0))
oly_lm <- glm(Total_2016~Total_2012+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_2012)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)
library(GGally)
ggscatmat(data.frame(oly_gdp_2016_2012), columns=c(5,3,4))
p1 <- ggplot(oly_gdp_2016_2012, aes(x=Population_mil, y=Total_2012,
label=Country)) +
geom_point() + xlim(c(0, 1500)) + ylim(c(0,150))
library(plotly)
ggplotly(p1)
library(car)
vif(oly_lm)
olympics2008 <- read_csv("../data/olympics2008.csv")
oly_gdp_2016_12_08 <- full_join(oly_gdp_2016_2012,
olympics2008[,c("Country","Total")],
by="Country")
colnames(oly_gdp_2016_12_08)[6] <- "Total_2008"
ggplot(oly_gdp_2016_12_08, aes(x=Total_2008, y=Total_2016)) + geom_point() +
theme_xkcd() + xkcdaxis(c(0,125),c(0,125))
oly_lm <- glm(Total_2016~Total_2012+Total_2008+Population_mil+GDP_PPP_bil, data=oly_gdp_2016_12_08)
oly_lm_est <- tidy(oly_lm)$estimate
tidy(oly_lm)

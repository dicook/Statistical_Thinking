data=train, na.action=na.omit, importance=TRUE)
rf_pred <- predict(tennis_rf, test)
RMSE(test$won, rf_pred)
test_aug <- cbind(test, glm_pred, rf_pred, xgb_pred)
p1 <- ggplot(test_aug, aes(x=glm_pred, y=won)) + geom_point()
p2 <- ggplot(test_aug, aes(x=rf_pred, y=won)) + geom_point()
p3 <- ggplot(test_aug, aes(x=xgb_pred, y=won)) + geom_point()
grid.arrange(p1, p2, p3, ncol=3)
test_aug <- cbind(test, glm_pred, rf_pred, xgb_pred)
p1 <- ggplot(test_aug, aes(x=glm_pred, y=won)) + geom_point()
p2 <- ggplot(test_aug, aes(x=rf_pred, y=won)) + geom_jitter()
p3 <- ggplot(test_aug, aes(x=xgb_pred, y=won)) + geom_jitter()
grid.arrange(p1, p2, p3, ncol=3)
summary(tennis_glm)$coefficients
tennis_rf$importance
importance_matrix <- xgb.importance(model = tennis_xgb)
importance_matrix
importance_matrix$Feature
print(importance_matrix)
xgb.plot.importance(importance_matrix = importance_matrix)
?xgb.importance
importance_matrix <- xgb.importance(colnames(mat_test), model = tennis_xgb)
print(importance_matrix)
colnames(mat_test)
importance_matrix <- xgb.importance(colnames(mat_test), model = tennis_xgb, data=mat)
importance_matrix <- xgb.importance(colnames(mat_test), model = tennis_xgb, data=mat, label=mat[,12])
print(importance_matrix)
importance_matrix
xgb_predict
xgb_pred
rf_pred <- predict(tennis_rf, test, type="response")
rf_pred
head(xgb_pred)
ggplot(test_aug, aes(x=xgb_pred, y=won)) + geom_point()
?randomForest
rf_pred <- predict(tennis_rf, test, type="prob")
View(rf_pred)
rf_pred <- predict(tennis_rf, test, type="votes")
rf_pred <- predict(tennis_rf, test, type="vote")
View(rf_pred)
rf_pred <- predict(tennis_rf, test, type="prob")
View(rf_pred)
rf_pred %>% mutate(p=max(`0`, `1`))
data.frame(rf_pred) %>% mutate(p=max(`0`, `1`))
data.frame(rf_pred)
data.frame(rf_pred) %>% mutate(p=max(X0, X1))
?mutate
as_tibble(rf_pred) %>% mutate(p=max(X0, X1))
data.frame(rf_pred) %>% mutate(p=ifelse(X0>X1, X0, X1))
tennis_rf <- randomForest(won~Winners+Unforced.Errors+
RPW.TPW+W.minus.Aces+
SPW.TPW+First.Serves.In+Total.Aces+
Total.Double.Faults+First.Serve.Pts.Won+
Receiving.Points.Won+Break.Point.Conversions,
data=train, na.action=na.omit, importance=TRUE)
rf_pred <- predict(tennis_rf, test, type="prob")
rf_pred <- predict(tennis_rf, test)
rf_pred
RMSE(test$won, rf_pred)
ggplot(test_aug, aes(x=rf_pred, y=won)) + geom_point()
test_aug <- cbind(test, glm_pred, rf_pred, xgb_pred)
head(test_aug)
p2 <- ggplot(test_aug, aes(x=rf_pred, y=won)) + geom_point()
p2
install.packages("curveRep")
install.packages("mclust")
install.packages("rARPACK")
library(curveRep)
help(package=curveRep)
data(wine)
dat = scale(as.matrix(wine[,-1]))
curveRep(dat,Y.Obs=wine[,1],nComponents = 2,
type='fourier',
COLS.Obs=brewer.pal(3,'Set1')[c(2,1,3)],
whichPlot='observations',
splatter.Obs=35,
splatter.Thresh=0.01,splatter.Weight=1/nrow(dat),
splatter.Ask=FALSE,metric=FALSE)
data(wine)
dat = scale(as.matrix(wine[,-1]))
curveRep(dat,Y.Obs=wine[,1],
type='fourier',
COLS.Obs=brewer.pal(3,'Set1')[c(2,1,3)],
whichPlot='observations',
splatter.Obs=35,
splatter.Thresh=0.01,splatter.Weight=1/nrow(dat),
splatter.Ask=FALSE,metric=FALSE)
dice = c(4, 6, 8, 12, 20)
dice_likelihood <- function(x, dice) {
if (x>dice)
l <- 0
else
l <- 1/dice
return(l)
}
dice_likelihood(6, 4)
dice_likelihood(6, 6)
dice_likelihood(6, 8)
dice_likelihood(6, 12)
dice_likelihood(6, 20)
dice_likelihood(6, dice)
dice_posterior <- function(x, dice) {
post <- NULL
for (i in length(dice)) {
post <- dice_likelihood(x, dice[i])
}
df <- data.frame(dice, post)
return(df)
}
dice_posterior(x, dice)
dice_posterior(6, dice)
dice_posterior <- function(x, dice) {
post <- NULL
for (i in length(dice)) {
post <- c(post, dice_likelihood(x, dice[i]))
}
df <- data.frame(dice, post)
return(df)
}
dice_posterior(6, dice)
dice_likelihood(6,6)
dice_likelihood(6,8)
prior <- rep(1/5, 5)
dice_posterior <- function(x, dice, prior) {
post <- NULL
for (i in length(dice)) {
post <- c(post, dice_likelihood(x, dice[i])*prior[i])
}
df <- data.frame(dice, post)
return(df)
}
dice_posterior(6, dice, prior)
post <- NULL
x<- 6
dice_likelihood(x, dice[1])
dice_likelihood(x, dice[2])
dice_likelihood(x, dice[3])
dice_likelihood(x, dice[4])
dice_likelihood(x, dice[5])
dice_posterior <- function(x, dice, prior) {
post <- NULL
for (i in 1:length(dice)) {
post <- c(post, dice_likelihood(x, dice[i])) #*prior[i])
}
df <- data.frame(dice, post)
return(df)
}
dice_posterior(6, dice, prior)
0.1667
0.1667+0.1250+0.0833+0.0500
dice_posterior(6, dice, prior)/0.425
dice_posterior <- function(x, dice, prior) {
post <- NULL
for (i in 1:length(dice)) {
post <- c(post, dice_likelihood(x, dice[i]))
}
df <- data.frame(dice, post=post/sum(post))
return(df)
}
dice_posterior <- function(x, dice) {
post <- NULL
for (i in 1:length(dice)) {
post <- c(post, dice_likelihood(x, dice[i]))
}
df <- data.frame(dice, post=post/sum(post))
return(df)
}
dice_posterior(6, dice)
dice_posterior(8, dice)
0.484+0.323+0.194
dice_density <- function(x, dice) {
if (x>dice)
p <- 0
else
p <- 1/dice
return(p)
}
dice_likelihood <- function(x, dice) {
l <- 1
for (i in 1:length(x)) {
l <- l*dice_density(x[i], dice)
}
return(l)
}
dice_posterior(c(6, 8, 7, 7, 5, 4), dice)
?any
dice_likelihood <- function(x, dice) {
if (any(x>dice))
l <- 0
else
l <- (1/dice)^x
return(l)
}
dice_posterior(c(6, 8, 7, 7, 5, 4), dice)
x<-c(6, 8, 7, 7, 5, 4)
dice
any(x>dice)
x>dice
check <- x>dice
check
any(check)
dice_likelihood <- function(x, dice) {
check <- x>dice
if (any(check))
l <- 0
else
l <- (1/dice)^x
return(l)
}
dice_posterior(c(6, 8, 7, 7, 5, 4), dice)
dice_likelihood <- function(x, dice) {
ll <- 1
for (i in 1:length(x)) {
if (x[1]>dice)
l <- 0
else
l <- 1/dice
ll <- ll*l
}
return(ll)
}
dice_likelihoodx, dice
dice_likelihood(x, dice)
x
dice
dice_likelihood <- function(x, dice) {
ll <- 1
for (i in 1:length(x)) {
if (x[i]>dice)
l <- 0
else
l <- 1/dice
ll <- ll*l
}
return(ll)
}
dice_posterior(c(6, 8, 7, 7, 5, 4), dice)
0.91585+0.08040+0.00375
0.943248453672+0.0552061280613+0.0015454182665
dice_posterior(c(6, 8, 7, 7, 5, 4), 8)
dice_likelihood(c(6, 8, 7, 7, 5, 4), 8)
dice_likelihood(c(6, 8, 7, 7, 5, 4), 12)
dice_likelihood(c(6, 8, 7, 7, 5, 4), 20)
3.81e-06+3.35e-07+1.56e-08
3.81e-06/4.16e-06
dice_posterior(c(6, 8, 7, 7, 5, 4), dice)
1/20+1/30+1/40+1/60+1/100
(1/20)/0.135
dice <- c(4, 6, 8, 12, 20)
dice_likelihood <- function(x, dice) {
if (x>dice)
l <- 0
else
l <- 1/dice
return(l)
}
prior <- 1/5
prob_D <- c(rep(5/50, 4), rep(4/50, 2), rep(3/50, 2),
rep(2/50, 4), rep(1/50, 8))
dice_posterior <- function(x, dice, prior, prob_D) {
post <- NULL
for (i in 1:length(dice)) {
post <- c(post, prior*dice_likelihood(x, dice[i])/prob_D[x])
}
df <- data.frame(dice, post)
return(df)
}
dice_posterior(6, dice, prior, prob_D)
x=6
dice
priot
prior
prob_D[x]
dice_posterior(4, dice, prior, prob_D)
0.500+0.333+0.250
0.417+0.312+0.208
0.417+0.312+0.208+0.125
sum(prob_D)
0.417+0.312+0.208+0.125
0.417/1.06
0.312/1.06
0.208/1.06
0.125/1.06
dice_posterior <- function(x, dice, prior, prob_D) {
post <- NULL
for (i in 1:length(dice)) {
post <- c(post, prior*dice_likelihood(x, dice[i])/prob_D[x])
}
df <- data.frame(dice, post=post/sum(post))
return(df)
}
dice_posterior(6, dice, prior, prob_D)
dice_posterior(4, dice, prior, prob_D)
0.3704+0.2469+0.1852+0.1235+0.0741
dice_posterior(8, dice, prior, prob_D)
dice_likelihood <- function(x, dice) {
ll <- 1
for (i in 1:length(x)) {
if (x[i]>dice)
l <- 0
else
l <- 1/dice
ll <- ll*l
}
return(ll)
}
dice_posterior(c(6, 8, 7, 7, 5, 4), dice)
dice_posterior(c(6, 8, 7, 7, 5, 4), prior, dice, prob_D)
x
x<- c(6, 8)
prod(prob_D[x])
dice_posterior <- function(x, dice, prior, prob_D) {
post <- NULL
pD <- prod(prob_D[x])
for (i in 1:length(dice)) {
post <- c(post, prior*dice_likelihood(x, dice[i])/pD)
}
df <- data.frame(dice, post=post/sum(post))
return(df)
}
dice_posterior(6, dice, prior, prob_D)
dice_likelihood <- function(x, dice) {
ll <- 1
for (i in 1:length(x)) {
if (x[i]>dice)
l <- 0
else
l <- 1/dice
ll <- ll*l
}
return(ll)
}
dice_posterior(c(6, 8, 7, 7, 5, 4), prior, dice, prob_D)
debug(dice_posterior)
dice_posterior(c(6, 8, 7, 7, 5, 4), prior, dice, prob_D)
pD
i
dice_likelihood(x, dice[i])
prior*dice_likelihood(x, dice[i])/pD
prior
undebug(dice_posterior)
prior <- 1/5
prior
dice_posterior(c(6, 8, 7, 7, 5, 4), prior, dice, prob_D)
debug(dice_posterior)
dice_posterior(c(6, 8, 7, 7, 5, 4), prior, dice, prob_D)
post
pD
i
dice_posterior(c(6, 8, 7, 7, 5, 4), prior, dice, prob_D)
prior
dice
undebug(dice_posterior)
dice_posterior(c(6, 8, 7, 7, 5, 4), dice, prior, prob_D)
loco <- 1:1000
df <- data.frame(loco, loco_likelihood(6, loco))
loco_likelihood <- function(x, loco){
if (x>loco)
l <- 0
else
l <- 1/loco
}
df <- data.frame(loco, loco_likelihood(6, loco))
l <- NULL
for (i in 1:length(loco))
l <- loco_likelihood(60, loco[i])
l <- NULL
for (i in 1:1000)
l <- loco_likelihood(60, i)
df <- data.frame(x=1:1000, l)
ggplot(df, aes(x, l)) + geom_line()
l <- NULL
for (i in 1:1000)
l <- c(l, loco_likelihood(60, i))
df <- data.frame(x=1:1000, l)
ggplot(df, aes(x, l)) + geom_line()
l <- NULL
for (i in 1:1000)
l <- c(l, loco_likelihood(60, i))
df <- data.frame(hyp=1:1000, l)
ggplot(df, aes(hyp, l)) + geom_line()
mean(l)
mean(df$l*df$hyp)
sum(df$l)
df <- data.frame(hyp=1:1000, l, post=l/sum(l))
ggplot(df, aes(hyp, post)) + geom_line()
mean(df$post*df$hyp)
df$post*df$hyp
sum(df$post*df$hyp)
df$post2 <- l*prior
df$post2 <- df$post2/sum(df$post2)
ggplot(df, aes(hyp, post)) + geom_line() + xlab("Number of trains") +
ylab("Probability") + geom_line(aes(y=post2), colour="blue")
prior <- (1/1:1000)^alpha
alpha=0.9
prior <- (1/1:1000)^alpha
prior
df$post2 <- df$post2/sum(df$post2)
df$post2 <- l*prior
df$post2 <- df$post2/sum(df$post2)
ggplot(df, aes(hyp, post)) + geom_line() + xlab("Number of trains") +
ylab("Probability") + geom_line(aes(y=post2), colour="blue")
alpha=0.9
prior <- (1/1:1000)^alpha
df <- data.frame(hyp=1:1000, l, unif=l/sum(l))
df$power <- l*prior
df$power <- df$power/sum(df$power)
df_m <- gather(prior, posterior, unif, power)
library(tidyverse)
library(gridExtra)
library(broom)
df_m <- gather(prior, posterior, unif, power)
?gather
df_m <- df %>% gather(prior, posterior, unif, power)
ggplot(df, aes(hyp, post)) + geom_line() + xlab("Number of trains") +
ylab("Probability") + geom_line(aes(y=post2), colour="blue")
ggplot(df, aes(x=hyp, y=posterior, colr=prior)) + geom_line() + xlab("Number of trains") +
ylab("Probability") +
scale_color_brewer(palette="Dark2")
ggplot(df_m, aes(x=hyp, y=posterior, colr=prior)) + geom_line() + xlab("Number of trains") +
ylab("Probability") +
scale_color_brewer(palette="Dark2")
ggplot(df_m, aes(x=hyp, y=posterior, color=prior)) + geom_line() + xlab("Number of trains") +
ylab("Probability") +
scale_color_brewer(palette="Dark2")
sum(df$power*df$hyp)
round(sum(df$power[1:10]*df$hyp[1:10]), 0)
?cumsum
probs <- cumsum(df$power)
probs
?which
which(probs > 0.1)
which(probs > 0.1)[1]
df$hyp[66]
sum(df$power[1:66]*df$hyp[1:66])
head(df)
df[61:70,]
which(probs > 0.1)[1]
which(probs > 0.95)[1]
which(probs > 0.05)[1]
library(knitr)
opts_chunk$set(
message = FALSE,
warning = FALSE,
cache = FALSE,
echo=FALSE,
fig.height = 6,
fig.width = 9,
fig.align='center'
)
options(digits=3)
library(tidyverse)
library(gridExtra)
library(broom)
dice <- c(4, 6, 8, 12, 20)
dice_likelihood <- function(x, dice) {
if (x>dice)
l <- 0
else
l <- 1/dice
return(l)
}
prior <- 1/5
prob_D <- c(rep(5/50, 4), rep(4/50, 2), rep(3/50, 2),
rep(2/50, 4), rep(1/50, 8))
dice_posterior <- function(x, dice, prior, prob_D) {
post <- NULL
pD <- prod(prob_D[x])
for (i in 1:length(dice)) {
post <- c(post, prior*dice_likelihood(x, dice[i])/pD)
}
df <- data.frame(dice, post=post/sum(post))
return(df)
}
dice_posterior(6, dice, prior, prob_D)
dice_posterior(4, dice, prior, prob_D)
dice_posterior(1, dice, prior, prob_D)
dice_posterior(7, dice, prior, prob_D)
dice_posterior(8, dice, prior, prob_D)
sample(seq(-10, 30, 1), 6)
devtools::install_github("jennybc/githug")
library(githug)
help(package="githug")
pal<-function(mat) rgb(mat[,1],mat[,2],mat[,3],maxColorValue=255)
showpal<-function(pal) {
n<-length(pal)
image(1:n, 1, as.matrix(1:n), col = pal,
xlab = deparse(substitute(pal)), ylab = "", xaxt = "n", yaxt = "n",
bty = "n")
}
rocker<-pal(rbind(c(110,3,40), c(53,111,44), c(250,100,0), c(44,32,30), c(2,6,186), c(54,30,54), c(200,71,78)))
black_plain<-pal(rbind(c(0,82,50), c(40,30,30), c(164,38,94), c(253,190,0), c(255,240,0), c(160,0,17)))
flood_tide <- pal(rbind(c(45,56,86), c(77,101,186), c(236,229,221), c(250,208,169), c(253,236,130)))
last_rays<-pal(rbind(c(60,60,60),c(120,150,180),c(230,230,220),c(250,170,114), c(190,92,85)))
red_sky_golden_cloud<-pal(rbind(c(0,40,25), c(68,111,4), c(0,91,205), c(242,200,210), c(255,150,0), c(255,43,0), c(77,50,150)))
winged_spill<-pal(rbind(c(90,60,75),c(232,112,75),c(115,100,133),c(253,238,98),c(98,133,138), c(188,68,82)))
pink_cloud<-pal(rbind(c(27,27,27),c(130,110,96),c(240,164,0),c(220,220,220),c(179,77,103)))
winter_light<-pal(rbind(c(218,212,60),c(242,238,195), c(146,38,31), c(68,33,86)))
winter_light
pink_cloud
library(tidyverse)
df <- data.frame(x1=c(rnorm(100), rnorm(100, 3)), x2=c(rnorm(100, -3), rnorm(100, 3)), x3 = c(rnorm(100, 3), rnorm(100)), group=c(rep("A", 100), "B", 100))
df <- data.frame(x1=c(rnorm(100), rnorm(100, 3)), x2=c(rnorm(100, -3), rnorm(100, 3)))
df <- data.frame(x1=c(rnorm(100), rnorm(100, 3)), x2=c(rnorm(100, -3), rnorm(100, 3)), x3 = c(rnorm(100, 3), rnorm(100)), )
df <- data.frame(x1=c(rnorm(100), rnorm(100, 3)),
x2=c(rnorm(100, -3), rnorm(100, 3)),
x3 = c(rnorm(100, 3), rnorm(100)),
group=c(rep("A", 100), rep("B", 100)))
length(rocker)
winter_light
ggplot(df, aes(x=x1, y=x2, colour=group)) + geom_point() +
scale_colour_manual(values=winter_light[1:2])

<!DOCTYPE html>
<html>
  <head>
    <title>Statistical Thinking using Randomisation and Simulation</title>
    <meta charset="utf-8">
    <meta name="author" content="Di Cook (dicook@monash.edu, @visnut)" />
    <link href="week4.class2_files/remark-css-0.0.1/example.css" rel="stylesheet" />
    <script src="week4.class2_files/htmlwidgets-0.9/htmlwidgets.js"></script>
    <script src="week4.class2_files/plotly-binding-4.7.1/plotly.js"></script>
    <script src="week4.class2_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="week4.class2_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="week4.class2_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="week4.class2_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="week4.class2_files/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="week4.class2_files/plotlyjs-1.29.2/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="myremark.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistical Thinking using Randomisation and Simulation
## Linear models
### Di Cook (<a href="mailto:dicook@monash.edu">dicook@monash.edu</a>, <span class="citation">@visnut</span>)
### W4.C2

---




# Overview of this class

- Fitting a linear model to olympic medal tally
- Review of linear regression

---
# Modeling Olympic medal counts

How does medal count in 2016 associate with that from the previous Olympics and the country's population and GDP?

![](week4.class2_files/figure-html/unnamed-chunk-1-1.png)&lt;!-- --&gt;

---
# Model fit summary
 
`$$M_{2016} = \beta_0 + \beta_1 M_{2012} + \beta_2 Population + \beta_3 GDP + \varepsilon$$`
 

```
#&gt;             term estimate std.error statistic p.value
#&gt; 1    (Intercept)   1.8604   0.49070       3.8 2.9e-04
#&gt; 2     Total_2012   0.7471   0.04108      18.2 1.6e-30
#&gt; 3 Population_mil  -0.0260   0.00384      -6.8 1.7e-09
#&gt; 4    GDP_PPP_bil   0.0024   0.00038       6.4 8.4e-09
```


```
#&gt;   null.deviance df.null logLik AIC BIC deviance df.residual
#&gt; 1         28518      85   -235 480 492     1192          82
```

---
# Fit and residuals

&lt;img src="week4.class2_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;

---
# Make plots interactive

<div id="e710aaa43ee" style="width:360px;height:360px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e710aaa43ee">{"x":{"data":[{"x":[115.080370469977,55.30562172685,79.4333374468803,68.5098963671211,42.0192114874201,38.7573576892351,32.0011240066432,26.0228434931091,26.4769926949335,31.0569458626371,18.3988148675227,14.935876886644,17.0499604796168,17.2583431223658,9.23178149533301,10.8081667308599,6.44888383553731,12.3483129028807,11.8699124295118,18.3852138921956,4.54869872696606,12.1486899163755,8.25413717416926,5.81724365055862,12.0495440980299,3.7728807514747,6.09602536989061,9.07137482867611,8.73981158737719,6.71490353089936,16.4780632400005,4.90001807432233,10.78437965724,5.79069035024155,5.01570804727223,5.04140222072412,5.10206749194653,7.04994621573357,9.49096165408591,10.986282313185,7.41491725112986,4.0830455315188,9.86884624208505,4.89705788613253,4.95339892126305,3.6424321717996,9.03169434004079,2.73215375652894,0.757431907049317,5.43247489159911,2.62225405565689,1.44645007282452,1.85657569511569,1.85188029012221,1.85354018252181,3.58348403635573,4.35998027083066,2.45121328014548,4.55501072527857,9.3683939556061,2.9946523648104,6.09785947052052,5.72210191684727,3.49472378416157,3.10598926466976,-6.7477374736536,5.6063208875764,1.60090835506095,2.60838980614713,1.43887567341734,1.04441464446547,4.07922193622659,5.5844337258477,3.6143160430552,4.12614165426748,2.34142309729225,2.62241850738616,3.44750152877163,3.41255608683572,4.50877639898516,2.40988027213472,1.81289609992265,-0.194273107913116,3.03503302037896,4.9260535023335,3.29309029040272],"y":[5.91962953002272,11.69437827315,-9.43333744688027,-12.5098963671211,-0.0192114874201437,2.24264231076486,9.99887599335682,-5.02284349310908,1.52300730506646,-2.05694586263707,0.601185132477259,0.0641231133560431,1.95003952038318,-0.258343122365762,3.76821850466699,0.191833269140119,3.55111616446269,-1.34831290288065,6.13008757048822,3.61478610780438,8.45130127303394,4.8513100836245,-0.254137174169255,1.18275634944138,-4.04954409802985,2.2271192485253,-2.09602536989061,5.92862517132389,2.26018841262281,3.28509646910064,-5.47806324000048,3.09998192567767,0.215620342760026,1.20930964975845,0.984291952727767,0.958597779275879,-1.10206749194653,-0.0499462157335691,8.50903834591409,-1.98628231318501,0.585082748870143,-0.0830455315187981,0.131153757914948,3.10294211386747,-0.953398921263047,-0.642432171799602,-4.03169434004079,-0.732153756528936,1.24256809295068,-2.43247489159911,-0.622254055656886,0.553549927175483,-0.856575695115693,-0.851880290122206,-0.853540182521808,-2.58348403635573,-3.35998027083066,-1.45121328014548,0.444989274721433,-4.3683939556061,-0.994652364810399,-4.09785947052052,-1.72210191684727,-0.49472378416157,-0.10598926466976,8.7477374736536,-3.6063208875764,-0.600908355060947,-1.60838980614713,-0.438875673417342,-0.0444146444654672,-3.07922193622659,-1.5844337258477,-0.614316043055198,-1.12614165426748,-0.34142309729225,-1.62241850738616,-2.44750152877163,-2.41255608683572,-3.50877639898516,-1.40988027213472,-0.812896099922646,1.19427310791312,-2.03503302037896,-3.9260535023335,-2.29309029040272],"text":[".fitted: 115.08<br />.resid:   5.920<br />Country: UnitedStates",".fitted:  55.31<br />.resid:  11.694<br />Country: GreatBritain",".fitted:  79.43<br />.resid:  -9.433<br />Country: China",".fitted:  68.51<br />.resid: -12.510<br />Country: RussianFed",".fitted:  42.02<br />.resid:  -0.019<br />Country: Germany",".fitted:  38.76<br />.resid:   2.243<br />Country: Japan",".fitted:  32.00<br />.resid:   9.999<br />Country: France",".fitted:  26.02<br />.resid:  -5.023<br />Country: SouthKorea",".fitted:  26.48<br />.resid:   1.523<br />Country: Italy",".fitted:  31.06<br />.resid:  -2.057<br />Country: Australia",".fitted:  18.40<br />.resid:   0.601<br />Country: Netherlands",".fitted:  14.94<br />.resid:   0.064<br />Country: Hungary",".fitted:  17.05<br />.resid:   1.950<br />Country: Brazil",".fitted:  17.26<br />.resid:  -0.258<br />Country: Spain",".fitted:   9.23<br />.resid:   3.768<br />Country: Kenya",".fitted:  10.81<br />.resid:   0.192<br />Country: Jamaica",".fitted:   6.45<br />.resid:   3.551<br />Country: Croatia",".fitted:  12.35<br />.resid:  -1.348<br />Country: Cuba",".fitted:  11.87<br />.resid:   6.130<br />Country: NewZealand",".fitted:  18.39<br />.resid:   3.615<br />Country: Canada",".fitted:   4.55<br />.resid:   8.451<br />Country: Uzbekistan",".fitted:  12.15<br />.resid:   4.851<br />Country: Kazakhstan",".fitted:   8.25<br />.resid:  -0.254<br />Country: Colombia",".fitted:   5.82<br />.resid:   1.183<br />Country: Switzerland",".fitted:  12.05<br />.resid:  -4.050<br />Country: Iran",".fitted:   3.77<br />.resid:   2.227<br />Country: Greece",".fitted:   6.10<br />.resid:  -2.096<br />Country: Argentina",".fitted:   9.07<br />.resid:   5.929<br />Country: Denmark",".fitted:   8.74<br />.resid:   2.260<br />Country: Sweden",".fitted:   6.71<br />.resid:   3.285<br />Country: SouthAfrica",".fitted:  16.48<br />.resid:  -5.478<br />Country: Ukraine",".fitted:   4.90<br />.resid:   3.100<br />Country: Serbia",".fitted:  10.78<br />.resid:   0.216<br />Country: Poland",".fitted:   5.79<br />.resid:   1.209<br />Country: NorthKorea",".fitted:   5.02<br />.resid:   0.984<br />Country: Belgium",".fitted:   5.04<br />.resid:   0.959<br />Country: Thailand",".fitted:   5.10<br />.resid:  -1.102<br />Country: Slovakia",".fitted:   7.05<br />.resid:  -0.050<br />Country: Georgia",".fitted:   9.49<br />.resid:   8.509<br />Country: Azerbaijan",".fitted:  10.99<br />.resid:  -1.986<br />Country: Belarus",".fitted:   7.41<br />.resid:   0.585<br />Country: Turkey",".fitted:   4.08<br />.resid:  -0.083<br />Country: Armenia",".fitted:   9.87<br />.resid:   0.131<br />Country: CzechRepublic",".fitted:   4.90<br />.resid:   3.103<br />Country: Ethiopia",".fitted:   4.95<br />.resid:  -0.953<br />Country: Slovenia",".fitted:   3.64<br />.resid:  -0.642<br />Country: Indonesia",".fitted:   9.03<br />.resid:  -4.032<br />Country: Romania",".fitted:   2.73<br />.resid:  -0.732<br />Country: Bahrain",".fitted:   0.76<br />.resid:   1.243<br />Country: Vietnam",".fitted:   5.43<br />.resid:  -2.432<br />Country: ChineseTaipei",".fitted:   2.62<br />.resid:  -0.622<br />Country: Bahamas",".fitted:   1.45<br />.resid:   0.554<br />Country: IvoryCoast",".fitted:   1.86<br />.resid:  -0.857<br />Country: Fiji",".fitted:   1.85<br />.resid:  -0.852<br />Country: Jordan",".fitted:   1.85<br />.resid:  -0.854<br />Country: Kosovo",".fitted:   3.58<br />.resid:  -2.583<br />Country: PuertoRico",".fitted:   4.36<br />.resid:  -3.360<br />Country: Singapore",".fitted:   2.45<br />.resid:  -1.451<br />Country: Tajikistan",".fitted:   4.56<br />.resid:   0.445<br />Country: Malaysia",".fitted:   9.37<br />.resid:  -4.368<br />Country: Mexico",".fitted:   2.99<br />.resid:  -0.995<br />Country: Algeria",".fitted:   6.10<br />.resid:  -4.098<br />Country: Ireland",".fitted:   5.72<br />.resid:  -1.722<br />Country: Lithuania",".fitted:   3.49<br />.resid:  -0.495<br />Country: Bulgaria",".fitted:   3.11<br />.resid:  -0.106<br />Country: Venezuela",".fitted:  -6.75<br />.resid:   8.748<br />Country: India",".fitted:   5.61<br />.resid:  -3.606<br />Country: Mongolia",".fitted:   1.60<br />.resid:  -0.601<br />Country: Burundi",".fitted:   2.61<br />.resid:  -1.608<br />Country: Grenada",".fitted:   1.44<br />.resid:  -0.439<br />Country: Niger",".fitted:   1.04<br />.resid:  -0.044<br />Country: Philippines",".fitted:   4.08<br />.resid:  -3.079<br />Country: Qatar",".fitted:   5.58<br />.resid:  -1.584<br />Country: Norway",".fitted:   3.61<br />.resid:  -0.614<br />Country: Egypt",".fitted:   4.13<br />.resid:  -1.126<br />Country: Tunisia",".fitted:   2.34<br />.resid:  -0.341<br />Country: Israel",".fitted:   2.62<br />.resid:  -1.622<br />Country: Austria",".fitted:   3.45<br />.resid:  -2.448<br />Country: DominicanRep.",".fitted:   3.41<br />.resid:  -2.413<br />Country: Estonia",".fitted:   4.51<br />.resid:  -3.509<br />Country: Finland",".fitted:   2.41<br />.resid:  -1.410<br />Country: Morocco",".fitted:   1.81<br />.resid:  -0.813<br />Country: Moldova",".fitted:  -0.19<br />.resid:   1.194<br />Country: Nigeria",".fitted:   3.04<br />.resid:  -2.035<br />Country: Portugal",".fitted:   4.93<br />.resid:  -3.926<br />Country: TrinidadTobago",".fitted:   3.29<br />.resid:  -2.293<br />Country: U.A.E."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-12.8391428708351,121.171775867159],"ticktext":["0","40","80","120"],"tickvals":[0,40,80,120],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Fitted","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-13.7201100991346,12.9045920051636],"ticktext":["-10","-5","0","5","10"],"tickvals":[-10,-5,0,5,10],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Residuals","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"e7104ee2c7c8":{"x":{},"y":{},"label":{},"type":"ggplotly"}},"cur_data":"e7104ee2c7c8","visdat":{"e7104ee2c7c8":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>

---
# Make plots interactive

<div id="e710597dc68c" style="width:360px;height:360px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e710597dc68c">{"x":{"data":[{"x":[115.080370469977,55.30562172685,79.4333374468803,68.5098963671211,42.0192114874201,38.7573576892351,32.0011240066432,26.0228434931091,26.4769926949335,31.0569458626371,18.3988148675227,14.935876886644,17.0499604796168,17.2583431223658,9.23178149533301,10.8081667308599,6.44888383553731,12.3483129028807,11.8699124295118,18.3852138921956,4.54869872696606,12.1486899163755,8.25413717416926,5.81724365055862,12.0495440980299,3.7728807514747,6.09602536989061,9.07137482867611,8.73981158737719,6.71490353089936,16.4780632400005,4.90001807432233,10.78437965724,5.79069035024155,5.01570804727223,5.04140222072412,5.10206749194653,7.04994621573357,9.49096165408591,10.986282313185,7.41491725112986,4.0830455315188,9.86884624208505,4.89705788613253,4.95339892126305,3.6424321717996,9.03169434004079,2.73215375652894,0.757431907049317,5.43247489159911,2.62225405565689,1.44645007282452,1.85657569511569,1.85188029012221,1.85354018252181,3.58348403635573,4.35998027083066,2.45121328014548,4.55501072527857,9.3683939556061,2.9946523648104,6.09785947052052,5.72210191684727,3.49472378416157,3.10598926466976,-6.7477374736536,5.6063208875764,1.60090835506095,2.60838980614713,1.43887567341734,1.04441464446547,4.07922193622659,5.5844337258477,3.6143160430552,4.12614165426748,2.34142309729225,2.62241850738616,3.44750152877163,3.41255608683572,4.50877639898516,2.40988027213472,1.81289609992265,-0.194273107913116,3.03503302037896,4.9260535023335,3.29309029040272],"y":[121,67,70,56,42,41,42,21,28,29,19,15,19,17,13,11,10,11,18,22,13,17,8,7,8,6,4,15,11,10,11,8,11,7,6,6,4,7,18,9,8,4,10,8,4,3,5,2,2,3,2,2,1,1,1,1,1,1,5,5,2,2,4,3,3,2,2,1,1,1,1,1,4,3,3,2,1,1,1,1,1,1,1,1,1,1],"text":[".fitted: 115.08<br />Total_2016: 121<br />Country: UnitedStates",".fitted:  55.31<br />Total_2016:  67<br />Country: GreatBritain",".fitted:  79.43<br />Total_2016:  70<br />Country: China",".fitted:  68.51<br />Total_2016:  56<br />Country: RussianFed",".fitted:  42.02<br />Total_2016:  42<br />Country: Germany",".fitted:  38.76<br />Total_2016:  41<br />Country: Japan",".fitted:  32.00<br />Total_2016:  42<br />Country: France",".fitted:  26.02<br />Total_2016:  21<br />Country: SouthKorea",".fitted:  26.48<br />Total_2016:  28<br />Country: Italy",".fitted:  31.06<br />Total_2016:  29<br />Country: Australia",".fitted:  18.40<br />Total_2016:  19<br />Country: Netherlands",".fitted:  14.94<br />Total_2016:  15<br />Country: Hungary",".fitted:  17.05<br />Total_2016:  19<br />Country: Brazil",".fitted:  17.26<br />Total_2016:  17<br />Country: Spain",".fitted:   9.23<br />Total_2016:  13<br />Country: Kenya",".fitted:  10.81<br />Total_2016:  11<br />Country: Jamaica",".fitted:   6.45<br />Total_2016:  10<br />Country: Croatia",".fitted:  12.35<br />Total_2016:  11<br />Country: Cuba",".fitted:  11.87<br />Total_2016:  18<br />Country: NewZealand",".fitted:  18.39<br />Total_2016:  22<br />Country: Canada",".fitted:   4.55<br />Total_2016:  13<br />Country: Uzbekistan",".fitted:  12.15<br />Total_2016:  17<br />Country: Kazakhstan",".fitted:   8.25<br />Total_2016:   8<br />Country: Colombia",".fitted:   5.82<br />Total_2016:   7<br />Country: Switzerland",".fitted:  12.05<br />Total_2016:   8<br />Country: Iran",".fitted:   3.77<br />Total_2016:   6<br />Country: Greece",".fitted:   6.10<br />Total_2016:   4<br />Country: Argentina",".fitted:   9.07<br />Total_2016:  15<br />Country: Denmark",".fitted:   8.74<br />Total_2016:  11<br />Country: Sweden",".fitted:   6.71<br />Total_2016:  10<br />Country: SouthAfrica",".fitted:  16.48<br />Total_2016:  11<br />Country: Ukraine",".fitted:   4.90<br />Total_2016:   8<br />Country: Serbia",".fitted:  10.78<br />Total_2016:  11<br />Country: Poland",".fitted:   5.79<br />Total_2016:   7<br />Country: NorthKorea",".fitted:   5.02<br />Total_2016:   6<br />Country: Belgium",".fitted:   5.04<br />Total_2016:   6<br />Country: Thailand",".fitted:   5.10<br />Total_2016:   4<br />Country: Slovakia",".fitted:   7.05<br />Total_2016:   7<br />Country: Georgia",".fitted:   9.49<br />Total_2016:  18<br />Country: Azerbaijan",".fitted:  10.99<br />Total_2016:   9<br />Country: Belarus",".fitted:   7.41<br />Total_2016:   8<br />Country: Turkey",".fitted:   4.08<br />Total_2016:   4<br />Country: Armenia",".fitted:   9.87<br />Total_2016:  10<br />Country: CzechRepublic",".fitted:   4.90<br />Total_2016:   8<br />Country: Ethiopia",".fitted:   4.95<br />Total_2016:   4<br />Country: Slovenia",".fitted:   3.64<br />Total_2016:   3<br />Country: Indonesia",".fitted:   9.03<br />Total_2016:   5<br />Country: Romania",".fitted:   2.73<br />Total_2016:   2<br />Country: Bahrain",".fitted:   0.76<br />Total_2016:   2<br />Country: Vietnam",".fitted:   5.43<br />Total_2016:   3<br />Country: ChineseTaipei",".fitted:   2.62<br />Total_2016:   2<br />Country: Bahamas",".fitted:   1.45<br />Total_2016:   2<br />Country: IvoryCoast",".fitted:   1.86<br />Total_2016:   1<br />Country: Fiji",".fitted:   1.85<br />Total_2016:   1<br />Country: Jordan",".fitted:   1.85<br />Total_2016:   1<br />Country: Kosovo",".fitted:   3.58<br />Total_2016:   1<br />Country: PuertoRico",".fitted:   4.36<br />Total_2016:   1<br />Country: Singapore",".fitted:   2.45<br />Total_2016:   1<br />Country: Tajikistan",".fitted:   4.56<br />Total_2016:   5<br />Country: Malaysia",".fitted:   9.37<br />Total_2016:   5<br />Country: Mexico",".fitted:   2.99<br />Total_2016:   2<br />Country: Algeria",".fitted:   6.10<br />Total_2016:   2<br />Country: Ireland",".fitted:   5.72<br />Total_2016:   4<br />Country: Lithuania",".fitted:   3.49<br />Total_2016:   3<br />Country: Bulgaria",".fitted:   3.11<br />Total_2016:   3<br />Country: Venezuela",".fitted:  -6.75<br />Total_2016:   2<br />Country: India",".fitted:   5.61<br />Total_2016:   2<br />Country: Mongolia",".fitted:   1.60<br />Total_2016:   1<br />Country: Burundi",".fitted:   2.61<br />Total_2016:   1<br />Country: Grenada",".fitted:   1.44<br />Total_2016:   1<br />Country: Niger",".fitted:   1.04<br />Total_2016:   1<br />Country: Philippines",".fitted:   4.08<br />Total_2016:   1<br />Country: Qatar",".fitted:   5.58<br />Total_2016:   4<br />Country: Norway",".fitted:   3.61<br />Total_2016:   3<br />Country: Egypt",".fitted:   4.13<br />Total_2016:   3<br />Country: Tunisia",".fitted:   2.34<br />Total_2016:   2<br />Country: Israel",".fitted:   2.62<br />Total_2016:   1<br />Country: Austria",".fitted:   3.45<br />Total_2016:   1<br />Country: DominicanRep.",".fitted:   3.41<br />Total_2016:   1<br />Country: Estonia",".fitted:   4.51<br />Total_2016:   1<br />Country: Finland",".fitted:   2.41<br />Total_2016:   1<br />Country: Morocco",".fitted:   1.81<br />Total_2016:   1<br />Country: Moldova",".fitted:  -0.19<br />Total_2016:   1<br />Country: Nigeria",".fitted:   3.04<br />Total_2016:   1<br />Country: Portugal",".fitted:   4.93<br />Total_2016:   1<br />Country: TrinidadTobago",".fitted:   3.29<br />Total_2016:   1<br />Country: U.A.E."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-12.8391428708351,121.171775867159],"ticktext":["0","40","80","120"],"tickvals":[0,40,80,120],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Fitted","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-5,127],"ticktext":["0","25","50","75","100","125"],"tickvals":[0,25,50,75,100,125],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Observed Count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"e71074c78f01":{"x":{},"y":{},"label":{},"type":"ggplotly"}},"cur_data":"e71074c78f01","visdat":{"e71074c78f01":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>

---
# Simple linear model

The model,

`$$Y = \beta_0 + \beta_1 X + \varepsilon$$`

- Explains how response variable, `\(Y\)`, changes in relation to explanatory variable, `\(X\)`, on average.
- Use line to predict value of `\(Y\)` for a given value of `\(X\)`

&lt;img src="week4.class2_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---
# Observed, fitted, residuals

- Observed value is `\(Y\)` (a point on plot)
- Fitted value is `\(\hat{Y}\)`, a value that lies on the line
- Residual is the difference between observed and fitted, `\(e=Y-\hat{Y}\)`

![](regression.png)

---
# Fitting process

- Minimizing the sum of squared residuals produces the best fitting line.
- Minimizes `\(\sum e^2\)`
- Line that is closest to the points, as a whole.

---
# Parameter interpretation

- Line of best fit: `\(\hat{Y}=b_0+b_1X\)`
- `\(b_0\)` is the intercept of the line with y-axis
- `\(b_1\)` is the slope of the line

---
# Calculating manually

Given standard deviation of `\(X\)`, `\(s_x\)`, standard deviation of `\(Y\)`, `\(s_y\)`, and the correlation, `\(r\)`,  between the two, the slope is computed by

`$$b_1 = r\frac{s_y}{s_x}$$`

and given the sample means `\(\bar{X}, \bar{Y}\)`

`$$b_0 = \bar{Y} - b_1\bar{X}$$`

---
class: inverse middle 
# YOUR TURN

(Complete questions online)

- Is the point `\(\bar{X}, \bar{Y}\)` on the regression line?

---
# Prediction

For given `\(X\)` values, plug these into the model equation to predict `\(Y\)`, 

`$$\hat{Y} = b_0 + b_1 X$$`

---
# Goodness of fit

- `\(R^2\)` is the proportion of variation in `\(Y\)` that is explained by `\(X\)`. Computed by  $$ R^2 = 1- \frac{\sum e^2}{\sum Y^2} $$
- __Deviance__: up to a constant, minus twice the maximized log-likelihood. It is the modern analog to residual sum of squares, that measures the relative merits of two models. 

---
# Reading residual plots

- Make a histogram and normal probability plot of the residuals - for a good fit the shape should be pretty symmetric and bell-shaped
- Plot the residuals against the fitted values - for a good fit should be just a random splatter, no patterns

---
# Residual plots

![](residuals.png)

---
# More diagnostics

- __Influential points__: leverage (diagonal elements of hat matrix, values `\(&gt; 2p/n\)` would indicate cases with high influence), cooksd (Cooks distance, measures the change in the residual when the case is removed)
- __Collinearity__ between explanatory variables (multiple regression): variance inflation factor

![](week4.class2_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;

---
# Cautions

- Association is not causation
- Linear association only
- Extrapolation outside the range of the data is not recommended

---
# Anscombe's quartet

![](anscombe.png)

Always plot the data, because very different patterns can lead to the same correlation. 

---
# Resources

- [Statistics online textbook, Diez, Barr, Cetinkaya-Rundel](https://www.openintro.org/stat/textbook.php?stat_book=isrs)
- [Ancombe's quartet](http://en.wikipedia.org/wiki/Anscombe's_quartet)

---
class: inverse middle 
# Share and share alike

&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;Creative Commons Attribution 4.0 International License&lt;/a&gt;.
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>

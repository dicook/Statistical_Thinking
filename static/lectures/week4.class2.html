<!DOCTYPE html>
<html>
  <head>
    <title>Statistical Thinking using Randomisation and Simulation</title>
    <meta charset="utf-8">
    <meta name="author" content="Di Cook (dicook@monash.edu, @visnut)" />
    <link href="week4.class2_files/remark-css-0.0.1/example.css" rel="stylesheet" />
    <script src="week4.class2_files/htmlwidgets-0.9/htmlwidgets.js"></script>
    <script src="week4.class2_files/plotly-binding-4.7.1/plotly.js"></script>
    <script src="week4.class2_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="week4.class2_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="week4.class2_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="week4.class2_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="week4.class2_files/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="week4.class2_files/plotlyjs-1.29.2/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="myremark.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistical Thinking using Randomisation and Simulation
## Linear models
### Di Cook (<a href="mailto:dicook@monash.edu">dicook@monash.edu</a>, <span class="citation">@visnut</span>)
### W4.C2

---




# Overview of this class

- Fitting a linear model to olympic medal tally
- Review of linear regression

---
# Modeling Olympic medal counts

How does medal count in 2016 associate with that from the previous Olympics and the country's population and GDP?

![](week4.class2_files/figure-html/unnamed-chunk-1-1.png)&lt;!-- --&gt;

---
# Model fit summary
 
`$$M_{2016} = \beta_0 + \beta_1 M_{2012} + \beta_2 Population + \beta_3 GDP + \varepsilon$$`
 

```
#&gt;             term estimate std.error statistic p.value
#&gt; 1    (Intercept)    -0.60     0.282      -2.1 3.6e-02
#&gt; 2     Total_2012     0.12     0.031       3.8 2.7e-04
#&gt; 3 Population_mil     0.54     0.095       5.7 1.8e-07
#&gt; 4    GDP_PPP_bil     0.26     0.088       3.0 3.8e-03
```


```
#&gt;   null.deviance df.null logLik AIC BIC deviance df.residual
#&gt; 1          4056      86   -189 389 401      396          83
```

---
# Fit and residuals

&lt;img src="week4.class2_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;

---
# Make plots interactive

<div id="89b056c7b757" style="width:360px;height:360px;" class="plotly html-widget"></div>
<script type="application/json" data-for="89b056c7b757">{"x":{"data":[{"x":[0.596684597556512,0.41473601412187,1.37510753493114,12.1338741397113,-0.340010147511227,6.99216958681686,-0.22071527672323,0.0568514017578803,4.03766063709183,1.35980737376755,6.23833441726412,0.70067930718092,-0.0624434690301164,7.09852835651391,26.4315989391459,0.160846111382288,2.21854824502505,2.25752518193017,3.19658398707056,3.50620405587113,5.54624196827766,-0.101420405935233,0.42311262869981,-0.101420405935233,2.6237864088721,-0.602276664828748,0.0178744648527632,16.8424777087838,1.82168669575595,13.9790273675923,24.0265842341574,0.70067930718092,0.0568514017578803,4.09430179523318,-0.340010147511227,0.915592273015385,0.715979468344509,2.41816104969593,1.0738640807085,-0.0777436301937053,11.3141102053589,-0.340010147511227,2.97329440665815,13.7571908551721,-0.602276664828748,6.00812129026606,4.21123260594853,-0.602276664828748,1.32083043686243,2.05791237725929,2.37682005271817,-0.340010147511227,0.796297402227389,-0.22071527672323,6.6115191907917,7.11838800419051,-0.0624434690301164,-0.340010147511227,1.54175595720219,0.923968887593325,-0.0624434690301164,3.78377073435224,-0.22071527672323,-0.363686923252755,0.176146272545877,1.79800992001442,14.0977846885795,2.55876863615281,-0.363686923252755,0.954569209920502,1.21683572723802,3.87702476932607,3.37762157842484,5.15866802566685,4.37788102821958,1.47910224455555,-0.482981794040752,1.35980737376755,0.13716933564076,0.542407499487806,2.66276334577722,-0.340010147511227,5.53185279919443,41.7443457997381,2.79043483114315,0.581384436392923,-0.0624434690301164],"y":[-0.596684597556512,2.58526398587813,-0.375107534931138,-4.1338741397113,0.340010147511227,-5.99216958681686,1.22071527672323,0.94314859824212,-3.03766063709183,0.640192626232451,0.761665582735883,-0.70067930718092,0.0624434690301164,-3.09852835651391,-0.4315989391459,0.839153888617712,0.781451754974946,2.74247481806983,1.80341601292944,-2.50620405587113,-3.54624196827766,0.101420405935233,-0.42311262869981,0.101420405935233,-1.6237864088721,1.60227666482875,-0.0178744648527632,-6.84247770878382,0.178313304244053,3.02097263240775,2.97341576584256,2.29932069281908,-0.0568514017578803,3.90569820476682,1.34001014751123,-0.915592273015385,0.284020531655491,0.58183895030407,-1.0738640807085,0.0777436301937053,-3.31411020535892,1.34001014751123,3.02670559334185,-1.75719085517214,1.60227666482875,-3.00812129026606,1.78876739405147,1.60227666482875,-1.32083043686243,-2.05791237725929,-2.37682005271817,0.340010147511227,-0.796297402227389,0.22071527672323,1.3884808092083,-3.11838800419051,0.0624434690301164,0.340010147511227,0.458244042797809,-0.923968887593325,0.0624434690301164,-1.78377073435224,0.22071527672323,1.36368692325276,-0.176146272545877,-0.798009920014419,4.90221531142046,-0.55876863615281,1.36368692325276,1.0454307900795,-0.216835727238024,-1.87702476932607,5.62237842157516,1.84133197433315,-2.37788102821958,1.52089775544445,1.48298179404075,0.640192626232451,-0.13716933564076,-0.542407499487806,-1.66276334577722,0.340010147511227,-3.53185279919443,4.25565420026189,1.20956516885685,-0.581384436392923,1.06244346903012],"text":[".fitted:  0.597<br />.resid: -0.597<br />Country: UnitedStates",".fitted:  0.415<br />.resid:  2.585<br />Country: GreatBritain",".fitted:  1.375<br />.resid: -0.375<br />Country: China",".fitted: 12.134<br />.resid: -4.134<br />Country: Russia",".fitted: -0.340<br />.resid:  0.340<br />Country: Germany",".fitted:  6.992<br />.resid: -5.992<br />Country: Japan",".fitted: -0.221<br />.resid:  1.221<br />Country: France",".fitted:  0.057<br />.resid:  0.943<br />Country: SouthKorea",".fitted:  4.038<br />.resid: -3.038<br />Country: Italy",".fitted:  1.360<br />.resid:  0.640<br />Country: Australia",".fitted:  6.238<br />.resid:  0.762<br />Country: Netherlands",".fitted:  0.701<br />.resid: -0.701<br />Country: Hungary",".fitted: -0.062<br />.resid:  0.062<br />Country: Brazil",".fitted:  7.099<br />.resid: -3.099<br />Country: Spain",".fitted: 26.432<br />.resid: -0.432<br />Country: Kenya",".fitted:  0.161<br />.resid:  0.839<br />Country: Jamaica",".fitted:  2.219<br />.resid:  0.781<br />Country: Croatia",".fitted:  2.258<br />.resid:  2.742<br />Country: Cuba",".fitted:  3.197<br />.resid:  1.803<br />Country: NewZealand",".fitted:  3.506<br />.resid: -2.506<br />Country: Canada",".fitted:  5.546<br />.resid: -3.546<br />Country: Uzbekistan",".fitted: -0.101<br />.resid:  0.101<br />Country: Kazakhstan",".fitted:  0.423<br />.resid: -0.423<br />Country: Colombia",".fitted: -0.101<br />.resid:  0.101<br />Country: Switzerland",".fitted:  2.624<br />.resid: -1.624<br />Country: Iran",".fitted: -0.602<br />.resid:  1.602<br />Country: Greece",".fitted:  0.018<br />.resid: -0.018<br />Country: Argentina",".fitted: 16.842<br />.resid: -6.842<br />Country: Denmark",".fitted:  1.822<br />.resid:  0.178<br />Country: Sweden",".fitted: 13.979<br />.resid:  3.021<br />Country: SouthAfrica",".fitted: 24.027<br />.resid:  2.973<br />Country: Ukraine",".fitted:  0.701<br />.resid:  2.299<br />Country: Serbia",".fitted:  0.057<br />.resid: -0.057<br />Country: Poland",".fitted:  4.094<br />.resid:  3.906<br />Country: NorthKorea",".fitted: -0.340<br />.resid:  1.340<br />Country: Belgium",".fitted:  0.916<br />.resid: -0.916<br />Country: Thailand",".fitted:  0.716<br />.resid:  0.284<br />Country: Slovakia",".fitted:  2.418<br />.resid:  0.582<br />Country: Georgia",".fitted:  1.074<br />.resid: -1.074<br />Country: Azerbaijan",".fitted: -0.078<br />.resid:  0.078<br />Country: Belarus",".fitted: 11.314<br />.resid: -3.314<br />Country: Turkey",".fitted: -0.340<br />.resid:  1.340<br />Country: Armenia",".fitted:  2.973<br />.resid:  3.027<br />Country: CzechRepublic",".fitted: 13.757<br />.resid: -1.757<br />Country: Ethiopia",".fitted: -0.602<br />.resid:  1.602<br />Country: Slovenia",".fitted:  6.008<br />.resid: -3.008<br />Country: Indonesia",".fitted:  4.211<br />.resid:  1.789<br />Country: Romania",".fitted: -0.602<br />.resid:  1.602<br />Country: Bahrain",".fitted:  1.321<br />.resid: -1.321<br />Country: Vietnam",".fitted:  2.058<br />.resid: -2.058<br />Country: ChineseTaipei",".fitted:  2.377<br />.resid: -2.377<br />Country: Bahamas",".fitted: -0.340<br />.resid:  0.340<br />Country: IvoryCoast",".fitted:  0.796<br />.resid: -0.796<br />Country: Independent",".fitted: -0.221<br />.resid:  0.221<br />Country: Fiji",".fitted:  6.612<br />.resid:  1.388<br />Country: Jordan",".fitted:  7.118<br />.resid: -3.118<br />Country: Kosovo",".fitted: -0.062<br />.resid:  0.062<br />Country: PuertoRico",".fitted: -0.340<br />.resid:  0.340<br />Country: Singapore",".fitted:  1.542<br />.resid:  0.458<br />Country: Tajikistan",".fitted:  0.924<br />.resid: -0.924<br />Country: Malaysia",".fitted: -0.062<br />.resid:  0.062<br />Country: Mexico",".fitted:  3.784<br />.resid: -1.784<br />Country: Algeria",".fitted: -0.221<br />.resid:  0.221<br />Country: Ireland",".fitted: -0.364<br />.resid:  1.364<br />Country: Lithuania",".fitted:  0.176<br />.resid: -0.176<br />Country: Bulgaria",".fitted:  1.798<br />.resid: -0.798<br />Country: Venezuela",".fitted: 14.098<br />.resid:  4.902<br />Country: India",".fitted:  2.559<br />.resid: -0.559<br />Country: Mongolia",".fitted: -0.364<br />.resid:  1.364<br />Country: Burundi",".fitted:  0.955<br />.resid:  1.045<br />Country: Grenada",".fitted:  1.217<br />.resid: -0.217<br />Country: Niger",".fitted:  3.877<br />.resid: -1.877<br />Country: Philippines",".fitted:  3.378<br />.resid:  5.622<br />Country: Qatar",".fitted:  5.159<br />.resid:  1.841<br />Country: Norway",".fitted:  4.378<br />.resid: -2.378<br />Country: Egypt",".fitted:  1.479<br />.resid:  1.521<br />Country: Tunisia",".fitted: -0.483<br />.resid:  1.483<br />Country: Israel",".fitted:  1.360<br />.resid:  0.640<br />Country: Austria",".fitted:  0.137<br />.resid: -0.137<br />Country: DominicanRep.",".fitted:  0.542<br />.resid: -0.542<br />Country: Estonia",".fitted:  2.663<br />.resid: -1.663<br />Country: Finland",".fitted: -0.340<br />.resid:  0.340<br />Country: Morocco",".fitted:  5.532<br />.resid: -3.532<br />Country: Moldova",".fitted: 41.744<br />.resid:  4.256<br />Country: Nigeria",".fitted:  2.790<br />.resid:  1.210<br />Country: Portugal",".fitted:  0.581<br />.resid: -0.581<br />Country: TrinidadTobago",".fitted: -0.062<br />.resid:  1.062<br />Country: U.A.E."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[-2.71960778805709,43.8616769229665],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Fitted","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[-7.46572051530177,6.24562122809311],"tickmode":"array","ticktext":["-4","0","4"],"tickvals":[-4,8.88178419700125e-16,4],"categoryorder":"array","categoryarray":["-4","0","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Residuals","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"89b03533b942":{"x":{},"y":{},"label":{},"type":"scatter"}},"cur_data":"89b03533b942","visdat":{"89b03533b942":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>

---
# Make plots interactive

<div id="89b022fd14a5" style="width:360px;height:360px;" class="plotly html-widget"></div>
<script type="application/json" data-for="89b022fd14a5">{"x":{"data":[{"x":[0.596684597556512,0.41473601412187,1.37510753493114,12.1338741397113,-0.340010147511227,6.99216958681686,-0.22071527672323,0.0568514017578803,4.03766063709183,1.35980737376755,6.23833441726412,0.70067930718092,-0.0624434690301164,7.09852835651391,26.4315989391459,0.160846111382288,2.21854824502505,2.25752518193017,3.19658398707056,3.50620405587113,5.54624196827766,-0.101420405935233,0.42311262869981,-0.101420405935233,2.6237864088721,-0.602276664828748,0.0178744648527632,16.8424777087838,1.82168669575595,13.9790273675923,24.0265842341574,0.70067930718092,0.0568514017578803,4.09430179523318,-0.340010147511227,0.915592273015385,0.715979468344509,2.41816104969593,1.0738640807085,-0.0777436301937053,11.3141102053589,-0.340010147511227,2.97329440665815,13.7571908551721,-0.602276664828748,6.00812129026606,4.21123260594853,-0.602276664828748,1.32083043686243,2.05791237725929,2.37682005271817,-0.340010147511227,0.796297402227389,-0.22071527672323,6.6115191907917,7.11838800419051,-0.0624434690301164,-0.340010147511227,1.54175595720219,0.923968887593325,-0.0624434690301164,3.78377073435224,-0.22071527672323,-0.363686923252755,0.176146272545877,1.79800992001442,14.0977846885795,2.55876863615281,-0.363686923252755,0.954569209920502,1.21683572723802,3.87702476932607,3.37762157842484,5.15866802566685,4.37788102821958,1.47910224455555,-0.482981794040752,1.35980737376755,0.13716933564076,0.542407499487806,2.66276334577722,-0.340010147511227,5.53185279919443,41.7443457997381,2.79043483114315,0.581384436392923,-0.0624434690301164],"y":[0,3,1,8,0,1,1,1,1,2,7,0,0,4,26,1,3,5,5,1,2,0,0,0,1,1,0,10,2,17,27,3,0,8,1,0,1,3,0,0,8,1,6,12,1,3,6,1,0,0,0,0,0,0,8,4,0,0,2,0,0,2,0,1,0,1,19,2,1,2,1,2,9,7,2,3,1,2,0,0,1,0,2,46,4,0,1],"text":[".fitted:  0.597<br />Total_2016:  0<br />Country: UnitedStates",".fitted:  0.415<br />Total_2016:  3<br />Country: GreatBritain",".fitted:  1.375<br />Total_2016:  1<br />Country: China",".fitted: 12.134<br />Total_2016:  8<br />Country: Russia",".fitted: -0.340<br />Total_2016:  0<br />Country: Germany",".fitted:  6.992<br />Total_2016:  1<br />Country: Japan",".fitted: -0.221<br />Total_2016:  1<br />Country: France",".fitted:  0.057<br />Total_2016:  1<br />Country: SouthKorea",".fitted:  4.038<br />Total_2016:  1<br />Country: Italy",".fitted:  1.360<br />Total_2016:  2<br />Country: Australia",".fitted:  6.238<br />Total_2016:  7<br />Country: Netherlands",".fitted:  0.701<br />Total_2016:  0<br />Country: Hungary",".fitted: -0.062<br />Total_2016:  0<br />Country: Brazil",".fitted:  7.099<br />Total_2016:  4<br />Country: Spain",".fitted: 26.432<br />Total_2016: 26<br />Country: Kenya",".fitted:  0.161<br />Total_2016:  1<br />Country: Jamaica",".fitted:  2.219<br />Total_2016:  3<br />Country: Croatia",".fitted:  2.258<br />Total_2016:  5<br />Country: Cuba",".fitted:  3.197<br />Total_2016:  5<br />Country: NewZealand",".fitted:  3.506<br />Total_2016:  1<br />Country: Canada",".fitted:  5.546<br />Total_2016:  2<br />Country: Uzbekistan",".fitted: -0.101<br />Total_2016:  0<br />Country: Kazakhstan",".fitted:  0.423<br />Total_2016:  0<br />Country: Colombia",".fitted: -0.101<br />Total_2016:  0<br />Country: Switzerland",".fitted:  2.624<br />Total_2016:  1<br />Country: Iran",".fitted: -0.602<br />Total_2016:  1<br />Country: Greece",".fitted:  0.018<br />Total_2016:  0<br />Country: Argentina",".fitted: 16.842<br />Total_2016: 10<br />Country: Denmark",".fitted:  1.822<br />Total_2016:  2<br />Country: Sweden",".fitted: 13.979<br />Total_2016: 17<br />Country: SouthAfrica",".fitted: 24.027<br />Total_2016: 27<br />Country: Ukraine",".fitted:  0.701<br />Total_2016:  3<br />Country: Serbia",".fitted:  0.057<br />Total_2016:  0<br />Country: Poland",".fitted:  4.094<br />Total_2016:  8<br />Country: NorthKorea",".fitted: -0.340<br />Total_2016:  1<br />Country: Belgium",".fitted:  0.916<br />Total_2016:  0<br />Country: Thailand",".fitted:  0.716<br />Total_2016:  1<br />Country: Slovakia",".fitted:  2.418<br />Total_2016:  3<br />Country: Georgia",".fitted:  1.074<br />Total_2016:  0<br />Country: Azerbaijan",".fitted: -0.078<br />Total_2016:  0<br />Country: Belarus",".fitted: 11.314<br />Total_2016:  8<br />Country: Turkey",".fitted: -0.340<br />Total_2016:  1<br />Country: Armenia",".fitted:  2.973<br />Total_2016:  6<br />Country: CzechRepublic",".fitted: 13.757<br />Total_2016: 12<br />Country: Ethiopia",".fitted: -0.602<br />Total_2016:  1<br />Country: Slovenia",".fitted:  6.008<br />Total_2016:  3<br />Country: Indonesia",".fitted:  4.211<br />Total_2016:  6<br />Country: Romania",".fitted: -0.602<br />Total_2016:  1<br />Country: Bahrain",".fitted:  1.321<br />Total_2016:  0<br />Country: Vietnam",".fitted:  2.058<br />Total_2016:  0<br />Country: ChineseTaipei",".fitted:  2.377<br />Total_2016:  0<br />Country: Bahamas",".fitted: -0.340<br />Total_2016:  0<br />Country: IvoryCoast",".fitted:  0.796<br />Total_2016:  0<br />Country: Independent",".fitted: -0.221<br />Total_2016:  0<br />Country: Fiji",".fitted:  6.612<br />Total_2016:  8<br />Country: Jordan",".fitted:  7.118<br />Total_2016:  4<br />Country: Kosovo",".fitted: -0.062<br />Total_2016:  0<br />Country: PuertoRico",".fitted: -0.340<br />Total_2016:  0<br />Country: Singapore",".fitted:  1.542<br />Total_2016:  2<br />Country: Tajikistan",".fitted:  0.924<br />Total_2016:  0<br />Country: Malaysia",".fitted: -0.062<br />Total_2016:  0<br />Country: Mexico",".fitted:  3.784<br />Total_2016:  2<br />Country: Algeria",".fitted: -0.221<br />Total_2016:  0<br />Country: Ireland",".fitted: -0.364<br />Total_2016:  1<br />Country: Lithuania",".fitted:  0.176<br />Total_2016:  0<br />Country: Bulgaria",".fitted:  1.798<br />Total_2016:  1<br />Country: Venezuela",".fitted: 14.098<br />Total_2016: 19<br />Country: India",".fitted:  2.559<br />Total_2016:  2<br />Country: Mongolia",".fitted: -0.364<br />Total_2016:  1<br />Country: Burundi",".fitted:  0.955<br />Total_2016:  2<br />Country: Grenada",".fitted:  1.217<br />Total_2016:  1<br />Country: Niger",".fitted:  3.877<br />Total_2016:  2<br />Country: Philippines",".fitted:  3.378<br />Total_2016:  9<br />Country: Qatar",".fitted:  5.159<br />Total_2016:  7<br />Country: Norway",".fitted:  4.378<br />Total_2016:  2<br />Country: Egypt",".fitted:  1.479<br />Total_2016:  3<br />Country: Tunisia",".fitted: -0.483<br />Total_2016:  1<br />Country: Israel",".fitted:  1.360<br />Total_2016:  2<br />Country: Austria",".fitted:  0.137<br />Total_2016:  0<br />Country: DominicanRep.",".fitted:  0.542<br />Total_2016:  0<br />Country: Estonia",".fitted:  2.663<br />Total_2016:  1<br />Country: Finland",".fitted: -0.340<br />Total_2016:  0<br />Country: Morocco",".fitted:  5.532<br />Total_2016:  2<br />Country: Moldova",".fitted: 41.744<br />Total_2016: 46<br />Country: Nigeria",".fitted:  2.790<br />Total_2016:  4<br />Country: Portugal",".fitted:  0.581<br />Total_2016:  0<br />Country: TrinidadTobago",".fitted: -0.062<br />Total_2016:  1<br />Country: U.A.E."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[-2.71960778805709,43.8616769229665],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Fitted","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[-2.3,48.3],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Observed Count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"89b04131a7c3":{"x":{},"y":{},"label":{},"type":"scatter"}},"cur_data":"89b04131a7c3","visdat":{"89b04131a7c3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>

---
# Simple linear model

The model,

`$$Y = \beta_0 + \beta_1 X + \varepsilon$$`

- Explains how response variable, `\(Y\)`, changes in relation to explanatory variable, `\(X\)`, on average.
- Use line to predict value of `\(Y\)` for a given value of `\(X\)`

&lt;img src="week4.class2_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---
# Observed, fitted, residuals

- Observed value is `\(Y\)` (a point on plot)
- Fitted value is `\(\hat{Y}\)`, a value that lies on the line
- Residual is the difference between observed and fitted, `\(e=Y-\hat{Y}\)`

![](regression.png)

---
# Fitting process

- Minimizing the sum of squared residuals produces the best fitting line.
- Minimizes `\(\sum e^2\)`
- Line that is closest to the points, as a whole.

---
# Parameter interpretation

- Line of best fit: `\(\hat{Y}=b_0+b_1X\)`
- `\(b_0\)` is the intercept of the line with y-axis
- `\(b_1\)` is the slope of the line

---
# Calculating manually

Given standard deviation of `\(X\)`, `\(s_x\)`, standard deviation of `\(Y\)`, `\(s_y\)`, and the correlation, `\(r\)`,  between the two, the slope is computed by

`$$b_1 = r\frac{s_y}{s_x}$$`

and given the sample means `\(\bar{X}, \bar{Y}\)`

`$$b_0 = \bar{Y} - b_1\bar{X}$$`

---
class: inverse middle 
# YOUR TURN

(Complete questions online)

- Is the point `\(\bar{X}, \bar{Y}\)` on the regression line?

---
# Prediction

For given `\(X\)` values, plug these into the model equation to predict `\(Y\)`, 

`$$\hat{Y} = b_0 + b_1 X$$`

---
# Goodness of fit

- `\(R^2\)` is the proportion of variation in `\(Y\)` that is explained by `\(X\)`. Computed by  $$ R^2 = 1- \frac{\sum e^2}{\sum Y^2} $$
- __Deviance__: up to a constant, minus twice the maximized log-likelihood. It is the modern analog to residual sum of squares, that measures the relative merits of two models. 

---
# Reading residual plots

- Make a histogram and normal probability plot of the residuals - for a good fit the shape should be pretty symmetric and bell-shaped
- Plot the residuals against the fitted values - for a good fit should be just a random splatter, no patterns

---
# Residual plots

![](residuals.png)

---
# More diagnostics

- __Influential points__: leverage (diagonal elements of hat matrix, values `\(&gt; 2p/n\)` would indicate cases with high influence), cooksd (Cooks distance, measures the change in the residual when the case is removed)
- __Collinearity__ between explanatory variables (multiple regression): variance inflation factor

![](week4.class2_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;

---
# Cautions

- Association is not causation
- Linear association only
- Extrapolation outside the range of the data is not recommended

---
# Anscombe's quartet

![](anscombe.png)

Always plot the data, because very different patterns can lead to the same correlation. 

---
# Resources

- [Statistics online textbook, Diez, Barr, Cetinkaya-Rundel](https://www.openintro.org/stat/textbook.php?stat_book=isrs)
- [Ancombe's quartet](http://en.wikipedia.org/wiki/Anscombe's_quartet)

---
class: inverse middle 
# Share and share alike

&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;Creative Commons Attribution 4.0 International License&lt;/a&gt;.
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>

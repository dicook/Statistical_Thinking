<!DOCTYPE html>
<html>
  <head>
    <title>Statistical Thinking using Randomisation and Simulation</title>
    <meta charset="utf-8">
    <link href="week5.class1_files/remark-css-0.0.1/example.css" rel="stylesheet" />
    <script src="week5.class1_files/htmlwidgets-0.9/htmlwidgets.js"></script>
    <script src="week5.class1_files/plotly-binding-4.7.1/plotly.js"></script>
    <script src="week5.class1_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="week5.class1_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="week5.class1_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="week5.class1_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="week5.class1_files/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="week5.class1_files/plotlyjs-1.29.2/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="myremark.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistical Thinking using Randomisation and Simulation
## Linear models: diagnostics
### W5.C1

---




# Modeling Olympic medal counts

We fit the medal count for 2012, purely on the counts from 2008, to illustrate the influence diagnostics.


```
#&gt;          term estimate std.error statistic p.value
#&gt; 1 (Intercept)     0.72     0.526       1.4 1.7e-01
#&gt; 2       M2012     0.94     0.026      36.5 4.5e-58
```

Giving the model, 

`\(M_{2016}=\)` 0.72 `\(+\)` 0.94 `\(M_{2012} + \varepsilon\)`

---
class: inverse middle 
# Your turn

- Should the model be re-fit with the intercept forced to ZERO?

--
<div id="f3056dc2a047" style="width:360px;height:288px;" class="plotly html-widget"></div>
<script type="application/json" data-for="f3056dc2a047">{"x":{"data":[{"x":[104,65,88,82,44,38,34,28,28,35,20,17,17,17,11,12,6,14,13,18,4,13,8,4,12,2,4,9,8,6,20,4,10,6,3,3,4,7,10,12,5,3,10,7,4,2,9,1,0,2,1,0,0,0,0,0,2,2,1,2,7,1,5,5,2,1,6,5,0,1,0,0,2,4,2,3,0,0,2,2,3,1,0,1,4,0,2,1,1,1,1,1,1,2,1,1,1,1],"y":[121,67,70,55,42,41,42,21,28,29,19,15,19,17,13,11,10,11,18,22,13,17,8,7,8,6,4,15,11,10,11,8,11,7,6,6,4,7,18,9,8,4,10,8,4,3,4,2,2,3,2,2,2,1,1,1,1,1,1,5,5,2,2,4,3,3,2,2,1,1,1,1,1,4,3,3,2,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],"text":["UnitedStates<br />M2012: 104<br />M2016: 121","GreatBritain<br />M2012:  65<br />M2016:  67","China<br />M2012:  88<br />M2016:  70","RussianFed<br />M2012:  82<br />M2016:  55","Germany<br />M2012:  44<br />M2016:  42","Japan<br />M2012:  38<br />M2016:  41","France<br />M2012:  34<br />M2016:  42","SouthKorea<br />M2012:  28<br />M2016:  21","Italy<br />M2012:  28<br />M2016:  28","Australia<br />M2012:  35<br />M2016:  29","Netherlands<br />M2012:  20<br />M2016:  19","Hungary<br />M2012:  17<br />M2016:  15","Brazil<br />M2012:  17<br />M2016:  19","Spain<br />M2012:  17<br />M2016:  17","Kenya<br />M2012:  11<br />M2016:  13","Jamaica<br />M2012:  12<br />M2016:  11","Croatia<br />M2012:   6<br />M2016:  10","Cuba<br />M2012:  14<br />M2016:  11","NewZealand<br />M2012:  13<br />M2016:  18","Canada<br />M2012:  18<br />M2016:  22","Uzbekistan<br />M2012:   4<br />M2016:  13","Kazakhstan<br />M2012:  13<br />M2016:  17","Colombia<br />M2012:   8<br />M2016:   8","Switzerland<br />M2012:   4<br />M2016:   7","Iran<br />M2012:  12<br />M2016:   8","Greece<br />M2012:   2<br />M2016:   6","Argentina<br />M2012:   4<br />M2016:   4","Denmark<br />M2012:   9<br />M2016:  15","Sweden<br />M2012:   8<br />M2016:  11","SouthAfrica<br />M2012:   6<br />M2016:  10","Ukraine<br />M2012:  20<br />M2016:  11","Serbia<br />M2012:   4<br />M2016:   8","Poland<br />M2012:  10<br />M2016:  11","NorthKorea<br />M2012:   6<br />M2016:   7","Belgium<br />M2012:   3<br />M2016:   6","Thailand<br />M2012:   3<br />M2016:   6","Slovakia<br />M2012:   4<br />M2016:   4","Georgia<br />M2012:   7<br />M2016:   7","Azerbaijan<br />M2012:  10<br />M2016:  18","Belarus<br />M2012:  12<br />M2016:   9","Turkey<br />M2012:   5<br />M2016:   8","Armenia<br />M2012:   3<br />M2016:   4","CzechRepublic<br />M2012:  10<br />M2016:  10","Ethiopia<br />M2012:   7<br />M2016:   8","Slovenia<br />M2012:   4<br />M2016:   4","Indonesia<br />M2012:   2<br />M2016:   3","Romania<br />M2012:   9<br />M2016:   4","Bahrain<br />M2012:   1<br />M2016:   2","Vietnam<br />M2012:   0<br />M2016:   2","ChineseTaipei<br />M2012:   2<br />M2016:   3","Bahamas<br />M2012:   1<br />M2016:   2","IvoryCoast<br />M2012:   0<br />M2016:   2","IndependentOlympicAthletes<br />M2012:   0<br />M2016:   2","Fiji<br />M2012:   0<br />M2016:   1","Jordan<br />M2012:   0<br />M2016:   1","Kosovo<br />M2012:   0<br />M2016:   1","PuertoRico<br />M2012:   2<br />M2016:   1","Singapore<br />M2012:   2<br />M2016:   1","Tajikistan<br />M2012:   1<br />M2016:   1","Malaysia<br />M2012:   2<br />M2016:   5","Mexico<br />M2012:   7<br />M2016:   5","Algeria<br />M2012:   1<br />M2016:   2","Ireland<br />M2012:   5<br />M2016:   2","Lithuania<br />M2012:   5<br />M2016:   4","Bulgaria<br />M2012:   2<br />M2016:   3","Venezuela<br />M2012:   1<br />M2016:   3","India<br />M2012:   6<br />M2016:   2","Mongolia<br />M2012:   5<br />M2016:   2","Burundi<br />M2012:   0<br />M2016:   1","Grenada<br />M2012:   1<br />M2016:   1","Niger<br />M2012:   0<br />M2016:   1","Philippines<br />M2012:   0<br />M2016:   1","Qatar<br />M2012:   2<br />M2016:   1","Norway<br />M2012:   4<br />M2016:   4","Egypt<br />M2012:   2<br />M2016:   3","Tunisia<br />M2012:   3<br />M2016:   3","Israel<br />M2012:   0<br />M2016:   2","Austria<br />M2012:   0<br />M2016:   1","DominicanRep.<br />M2012:   2<br />M2016:   1","Estonia<br />M2012:   2<br />M2016:   1","Finland<br />M2012:   3<br />M2016:   1","Morocco<br />M2012:   1<br />M2016:   1","Nigeria<br />M2012:   0<br />M2016:   1","Portugal<br />M2012:   1<br />M2016:   1","TrinidadTobago<br />M2012:   4<br />M2016:   1","UnitedArabEmirates<br />M2012:   0<br />M2016:   1","Latvia<br />M2012:   2<br />M2016:   0","Uganda<br />M2012:   1<br />M2016:   0","Botswana<br />M2012:   1<br />M2016:   0","Cyprus<br />M2012:   1<br />M2016:   0","Gabon<br />M2012:   1<br />M2016:   0","Guatemala<br />M2012:   1<br />M2016:   0","Montenegro<br />M2012:   1<br />M2016:   0","Rep.ofMoldova<br />M2012:   2<br />M2016:   0","Afghanistan<br />M2012:   1<br />M2016:   0","HongKongChina<br />M2012:   1<br />M2016:   0","SaudiArabia<br />M2012:   1<br />M2016:   0","Kuwait<br />M2012:   1<br />M2016:   0"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1.31645569620253,2.63291139240506,3.94936708860759,5.26582278481013,6.58227848101266,7.89873417721519,9.21518987341772,10.5316455696203,11.8481012658228,13.1645569620253,14.4810126582278,15.7974683544304,17.1139240506329,18.4303797468354,19.746835443038,21.0632911392405,22.379746835443,23.6962025316456,25.0126582278481,26.3291139240506,27.6455696202532,28.9620253164557,30.2784810126582,31.5949367088608,32.9113924050633,34.2278481012658,35.5443037974684,36.8607594936709,38.1772151898734,39.4936708860759,40.8101265822785,42.126582278481,43.4430379746835,44.7594936708861,46.0759493670886,47.3924050632911,48.7088607594937,50.0253164556962,51.3417721518987,52.6582278481013,53.9746835443038,55.2911392405063,56.6075949367089,57.9240506329114,59.2405063291139,60.5569620253165,61.873417721519,63.1898734177215,64.506329113924,65.8227848101266,67.1392405063291,68.4556962025316,69.7721518987342,71.0886075949367,72.4050632911392,73.7215189873418,75.0379746835443,76.3544303797468,77.6708860759494,78.9873417721519,80.3037974683544,81.620253164557,82.9367088607595,84.253164556962,85.5696202531645,86.8860759493671,88.2025316455696,89.5189873417721,90.8354430379747,92.1518987341772,93.4683544303797,94.7848101265823,96.1012658227848,97.4177215189873,98.7341772151899,100.050632911392,101.367088607595,102.683544303797,104],"y":[0.720935937437611,1.95302389930024,3.18511186116286,4.41719982302549,5.64928778488811,6.88137574675074,8.11346370861336,9.34555167047599,10.5776396323386,11.8097275942012,13.0418155560639,14.2739035179265,15.5059914797891,16.7380794416517,17.9701674035144,19.202255365377,20.4343433272396,21.6664312891022,22.8985192509649,24.1306072128275,25.3626951746901,26.5947831365527,27.8268710984154,29.058959060278,30.2910470221406,31.5231349840032,32.7552229458659,33.9873109077285,35.2193988695911,36.4514868314537,37.6835747933164,38.915662755179,40.1477507170416,41.3798386789042,42.6119266407669,43.8440146026295,45.0761025644921,46.3081905263547,47.5402784882174,48.77236645008,50.0044544119426,51.2365423738052,52.4686303356679,53.7007182975305,54.9328062593931,56.1648942212558,57.3969821831184,58.629070144981,59.8611581068436,61.0932460687062,62.3253340305689,63.5574219924315,64.7895099542941,66.0215979161568,67.2536858780194,68.485773839882,69.7178618017446,70.9499497636073,72.1820377254699,73.4141256873325,74.6462136491951,75.8783016110578,77.1103895729204,78.342477534783,79.5745654966456,80.8066534585083,82.0387414203709,83.2708293822335,84.5029173440961,85.7350053059588,86.9670932678214,88.199181229684,89.4312691915466,90.6633571534093,91.8954451152719,93.1275330771345,94.3596210389971,95.5917090008598,96.8237969627224,98.055884924585],"text":["M2012:   0.0<br />M2016:  0.72","M2012:   1.3<br />M2016:  1.95","M2012:   2.6<br />M2016:  3.19","M2012:   3.9<br />M2016:  4.42","M2012:   5.3<br />M2016:  5.65","M2012:   6.6<br />M2016:  6.88","M2012:   7.9<br />M2016:  8.11","M2012:   9.2<br />M2016:  9.35","M2012:  10.5<br />M2016: 10.58","M2012:  11.8<br />M2016: 11.81","M2012:  13.2<br />M2016: 13.04","M2012:  14.5<br />M2016: 14.27","M2012:  15.8<br />M2016: 15.51","M2012:  17.1<br />M2016: 16.74","M2012:  18.4<br />M2016: 17.97","M2012:  19.7<br />M2016: 19.20","M2012:  21.1<br />M2016: 20.43","M2012:  22.4<br />M2016: 21.67","M2012:  23.7<br />M2016: 22.90","M2012:  25.0<br />M2016: 24.13","M2012:  26.3<br />M2016: 25.36","M2012:  27.6<br />M2016: 26.59","M2012:  29.0<br />M2016: 27.83","M2012:  30.3<br />M2016: 29.06","M2012:  31.6<br />M2016: 30.29","M2012:  32.9<br />M2016: 31.52","M2012:  34.2<br />M2016: 32.76","M2012:  35.5<br />M2016: 33.99","M2012:  36.9<br />M2016: 35.22","M2012:  38.2<br />M2016: 36.45","M2012:  39.5<br />M2016: 37.68","M2012:  40.8<br />M2016: 38.92","M2012:  42.1<br />M2016: 40.15","M2012:  43.4<br />M2016: 41.38","M2012:  44.8<br />M2016: 42.61","M2012:  46.1<br />M2016: 43.84","M2012:  47.4<br />M2016: 45.08","M2012:  48.7<br />M2016: 46.31","M2012:  50.0<br />M2016: 47.54","M2012:  51.3<br />M2016: 48.77","M2012:  52.7<br />M2016: 50.00","M2012:  54.0<br />M2016: 51.24","M2012:  55.3<br />M2016: 52.47","M2012:  56.6<br />M2016: 53.70","M2012:  57.9<br />M2016: 54.93","M2012:  59.2<br />M2016: 56.16","M2012:  60.6<br />M2016: 57.40","M2012:  61.9<br />M2016: 58.63","M2012:  63.2<br />M2016: 59.86","M2012:  64.5<br />M2016: 61.09","M2012:  65.8<br />M2016: 62.33","M2012:  67.1<br />M2016: 63.56","M2012:  68.5<br />M2016: 64.79","M2012:  69.8<br />M2016: 66.02","M2012:  71.1<br />M2016: 67.25","M2012:  72.4<br />M2016: 68.49","M2012:  73.7<br />M2016: 69.72","M2012:  75.0<br />M2016: 70.95","M2012:  76.4<br />M2016: 72.18","M2012:  77.7<br />M2016: 73.41","M2012:  79.0<br />M2016: 74.65","M2012:  80.3<br />M2016: 75.88","M2012:  81.6<br />M2016: 77.11","M2012:  82.9<br />M2016: 78.34","M2012:  84.3<br />M2016: 79.57","M2012:  85.6<br />M2016: 80.81","M2012:  86.9<br />M2016: 82.04","M2012:  88.2<br />M2016: 83.27","M2012:  89.5<br />M2016: 84.50","M2012:  90.8<br />M2016: 85.74","M2012:  92.2<br />M2016: 86.97","M2012:  93.5<br />M2016: 88.20","M2012:  94.8<br />M2016: 89.43","M2012:  96.1<br />M2016: 90.66","M2012:  97.4<br />M2016: 91.90","M2012:  98.7<br />M2016: 93.13","M2012: 100.1<br />M2016: 94.36","M2012: 101.4<br />M2016: 95.59","M2012: 102.7<br />M2016: 96.82","M2012: 104.0<br />M2016: 98.06"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.77952755905512,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,1.98275862068966,6.46551724137931,10.948275862069,15.4310344827586,19.9137931034483,24.3965517241379,28.8793103448276,33.3620689655172,37.8448275862069,42.3275862068966,46.8103448275862,51.2931034482759,55.7758620689655,60.2586206896552,64.7413793103448,69.2241379310345,73.7068965517241,78.1896551724138,82.6724137931035,87.1551724137931,91.6379310344827,96.1206896551724,100.603448275862,105.086206896552,109.568965517241,114.051724137931,118.534482758621,123.01724137931,127.5],"y":[-2.5,-2.74597160823281,-2.79908075926884,-2.74617384565655,-2.64947348828685,-2.55130693234343,-2.47803168347628,-2.44333274680653,-2.45103369292816,-2.49753406088579,-2.57395831817643,-2.6680767321489,-2.76603606575552,-2.85391799344774,-2.91912554010093,-2.95158267720204,-2.94471946613936,-2.89620481829435,-2.80838104575248,-2.68834890482305,-2.54764878718666,-2.40148309037396,-2.26742660042,-2.1635759449353,-2.10609582448744,-2.10612880409565,-2.16604694480538,-2.27503747773064,-2.40403106962813,-2.5],"text":["x:  -2.5<br />y: -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  -2.5<br />M2016: -2.5","x:   2.0<br />y: -2.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:   2.0<br />M2016: -2.7","x:   6.5<br />y: -2.8<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:   6.5<br />M2016: -2.8","x:  10.9<br />y: -2.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  10.9<br />M2016: -2.7","x:  15.4<br />y: -2.6<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  15.4<br />M2016: -2.6","x:  19.9<br />y: -2.6<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  19.9<br />M2016: -2.6","x:  24.4<br />y: -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  24.4<br />M2016: -2.5","x:  28.9<br />y: -2.4<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  28.9<br />M2016: -2.4","x:  33.4<br />y: -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  33.4<br />M2016: -2.5","x:  37.8<br />y: -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  37.8<br />M2016: -2.5","x:  42.3<br />y: -2.6<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  42.3<br />M2016: -2.6","x:  46.8<br />y: -2.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  46.8<br />M2016: -2.7","x:  51.3<br />y: -2.8<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  51.3<br />M2016: -2.8","x:  55.8<br />y: -2.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  55.8<br />M2016: -2.9","x:  60.3<br />y: -2.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  60.3<br />M2016: -2.9","x:  64.7<br />y: -3.0<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  64.7<br />M2016: -3.0","x:  69.2<br />y: -2.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  69.2<br />M2016: -2.9","x:  73.7<br />y: -2.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  73.7<br />M2016: -2.9","x:  78.2<br />y: -2.8<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  78.2<br />M2016: -2.8","x:  82.7<br />y: -2.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  82.7<br />M2016: -2.7","x:  87.2<br />y: -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  87.2<br />M2016: -2.5","x:  91.6<br />y: -2.4<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  91.6<br />M2016: -2.4","x:  96.1<br />y: -2.3<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012:  96.1<br />M2016: -2.3","x: 100.6<br />y: -2.2<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 100.6<br />M2016: -2.2","x: 105.1<br />y: -2.1<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 105.1<br />M2016: -2.1","x: 109.6<br />y: -2.1<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 109.6<br />M2016: -2.1","x: 114.1<br />y: -2.2<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 114.1<br />M2016: -2.2","x: 118.5<br />y: -2.3<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 118.5<br />M2016: -2.3","x: 123.0<br />y: -2.4<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 123.0<br />M2016: -2.4","x: 127.5<br />y: -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: 128<br />yend: -2.5<br />M2012: 127.5<br />M2016: -2.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-1.92899727797521,-1.61275701423481,-1.49396172224538,-1.52365541031118,-1.65944822801951,-1.8644918610786,-2.10699891456339,-2.36011315088145,-2.60196914292334,-2.81580966487096,-2.99005697300279,-3.11826002655647,-3.19886366428745,-3.23476778579667,-3.23266468799121,-3.20216087618904,-3.15470590638227,-3.10236512003373,-3.05648550549736,-3.02631436072618,-3.01763894036011,-3.0315218465716,-3.06321156718869,-3.10131027661325,-3.12728179490666,-3.11538144812596,-3.03308648856092,-2.84210071694582,-2.5],"y":[-2.5,1.98275862068966,6.46551724137931,10.948275862069,15.4310344827586,19.9137931034483,24.3965517241379,28.8793103448276,33.3620689655172,37.8448275862069,42.3275862068966,46.8103448275862,51.2931034482759,55.7758620689655,60.2586206896552,64.7413793103448,69.2241379310345,73.7068965517241,78.1896551724138,82.6724137931035,87.1551724137931,91.6379310344827,96.1206896551724,100.603448275862,105.086206896552,109.568965517241,114.051724137931,118.534482758621,123.01724137931,127.5],"text":["x: -2.5<br />y:  -2.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.5<br />M2016:  -2.5","x: -1.9<br />y:   2.0<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -1.9<br />M2016:   2.0","x: -1.6<br />y:   6.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -1.6<br />M2016:   6.5","x: -1.5<br />y:  10.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -1.5<br />M2016:  10.9","x: -1.5<br />y:  15.4<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -1.5<br />M2016:  15.4","x: -1.7<br />y:  19.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -1.7<br />M2016:  19.9","x: -1.9<br />y:  24.4<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -1.9<br />M2016:  24.4","x: -2.1<br />y:  28.9<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.1<br />M2016:  28.9","x: -2.4<br />y:  33.4<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.4<br />M2016:  33.4","x: -2.6<br />y:  37.8<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.6<br />M2016:  37.8","x: -2.8<br />y:  42.3<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.8<br />M2016:  42.3","x: -3.0<br />y:  46.8<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.0<br />M2016:  46.8","x: -3.1<br />y:  51.3<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016:  51.3","x: -3.2<br />y:  55.8<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.2<br />M2016:  55.8","x: -3.2<br />y:  60.3<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.2<br />M2016:  60.3","x: -3.2<br />y:  64.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.2<br />M2016:  64.7","x: -3.2<br />y:  69.2<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.2<br />M2016:  69.2","x: -3.2<br />y:  73.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.2<br />M2016:  73.7","x: -3.1<br />y:  78.2<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016:  78.2","x: -3.1<br />y:  82.7<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016:  82.7","x: -3.0<br />y:  87.2<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.0<br />M2016:  87.2","x: -3.0<br />y:  91.6<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.0<br />M2016:  91.6","x: -3.0<br />y:  96.1<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.0<br />M2016:  96.1","x: -3.1<br />y: 100.6<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016: 100.6","x: -3.1<br />y: 105.1<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016: 105.1","x: -3.1<br />y: 109.6<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016: 109.6","x: -3.1<br />y: 114.1<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.1<br />M2016: 114.1","x: -3.0<br />y: 118.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -3.0<br />M2016: 118.5","x: -2.8<br />y: 123.0<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.8<br />M2016: 123.0","x: -2.5<br />y: 127.5<br />xbegin: -2.5<br />ybegin: -2.5<br />xend: -2.5<br />yend: 128<br />M2012: -2.5<br />M2016: 127.5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.1324200913242,"r":7.30593607305936,"b":51.0419261104193,"l":57.7168949771689},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"xkcd","size":21.2536322125363},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-10.375,135.375],"ticktext":["0","50","100"],"tickvals":[0,50,100],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"xkcd","size":17.0029057700291},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"M2012","titlefont":{"color":"rgba(0,0,0,1)","family":"xkcd","size":21.2536322125363},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-10.375,135.375],"ticktext":["0","50","100"],"tickvals":[0,50,100],"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"xkcd","size":17.0029057700291},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"M2016","titlefont":{"color":"rgba(0,0,0,1)","family":"xkcd","size":21.2536322125363},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"xkcd","size":17.0029057700291}},"hovermode":"closest"},"source":"A","attrs":{"f305d40258e":{"text":{},"x":{},"y":{},"type":"ggplotly"},"f3056e61946d":{"x":{},"y":{}},"f3054857b8b8":{"x":{},"y":{},"xbegin":{},"ybegin":{},"xend":{},"yend":{},"x.1":{},"y.1":{}},"f30577205d22":{"x":{},"y":{},"xbegin":{},"ybegin":{},"xend":{},"yend":{},"x.1":{},"y.1":{}}},"cur_data":"f305d40258e","visdat":{"f305d40258e":["function (y) ","x"],"f3056e61946d":["function (y) ","x"],"f3054857b8b8":["function (y) ","x"],"f30577205d22":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>

---
# Model diagnostics

- Based on `leave-one-out` statistics
- For `\(n\)` observations, fit `\(n\)` models where each model has one observation removed. 
- Let's take a look at fitting the medal tallies, without the USA.


```
#&gt;    all noUSA  estimate
#&gt; 1 0.72  1.33 intercept
#&gt; 2 0.94  0.84     slope
```

--
- Parameter estimates change a little

---


&lt;img src="week5.class1_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

---
# Other model fit parameters

- deviance
- predicted values, residuals


|       | null.dev| deviance| fitted| resid|
|:------|--------:|--------:|------:|-----:|
|All    |    29766|     2002|     98|   5.9|
|No USA |    17298|     1260|     89|  15.3|

---
# What it could look like

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;

---
# Leverage

Leverage `\(h_{ii}\)` is defined for each observation, `\(1, ..., n\)`, and is the `\(i^{th}\)` diagonal element of the hat matrix:

`$$H=X(X^TX)^{-1}X^T$$`

where `\(X\)` is the design matrix, e.g. for `\(\beta_0+\beta_1x\)`, 

`$$X=\left[ \begin{array}{cc} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \vdots &amp; \vdots \\ 1 &amp; x_n \end{array} \right]$$`

Intuitively, observations which are far from the mean of the explanatory variables will have higher leverage. 

YOU CAN CALCULATE THIS WITHOUT FITTING ALL `\(n\)` MODELS!

---
# Highest leverage for medal tally model


```
#&gt;                       Country  .hat
#&gt; 1                UnitedStates 0.290
#&gt; 2                       China 0.203
#&gt; 3                  RussianFed 0.175
#&gt; 4                GreatBritain 0.106
#&gt; 5                     Germany 0.047
#&gt; 6                       Japan 0.035
#&gt; 7                   Australia 0.030
#&gt; 8                      France 0.029
#&gt; 9                  SouthKorea 0.021
#&gt; 10                      Italy 0.021
#&gt; 11                Netherlands 0.013
#&gt; 12                    Ukraine 0.013
#&gt; 13                    Vietnam 0.013
#&gt; 14                 IvoryCoast 0.013
#&gt; 15 IndependentOlympicAthletes 0.013
```

Cutoff for high leverage is `\(2p/n = 2*1/73 = 0.027\)`.

---
# Plot of leverage

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---
# Log-tranform the counts

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;

---


```
#&gt;                       Country  .hat
#&gt; 1                UnitedStates 0.081
#&gt; 2                       China 0.074
#&gt; 3                  RussianFed 0.070
#&gt; 4                GreatBritain 0.061
#&gt; 5                     Germany 0.047
#&gt; 6                       Japan 0.042
#&gt; 7                   Australia 0.040
#&gt; 8                      France 0.039
#&gt; 9                  SouthKorea 0.034
#&gt; 10                      Italy 0.034
#&gt; 11                    Vietnam 0.030
#&gt; 12                 IvoryCoast 0.030
#&gt; 13 IndependentOlympicAthletes 0.030
#&gt; 14                       Fiji 0.030
#&gt; 15                     Jordan 0.030
```

---


&lt;img src="week5.class1_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;

Transforming skewed variables reduces the influence of any one, or few points. The distribution is more even, and the highest leverage value is much lower now.

---
# Hat values for simulated data

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;

---
# Cooks D

Leverage takes no notice of the response variable. So the USA did not have a huge influence because its medal count in 2012 was similar to that in 2008, so it was close to the trend. If for some reason the medal count in 2012 was 0, the line with the USA would be much more drawn away from the other countries. 

Cooks D, and DFFITS, also use the response variable, to assess influence. 

`$$D_i = \frac{e_i^2}{{MSE}^2p}\frac{h_{ii}}{(1-h_{ii})^2}$$`

where `\(e_i\)` is the `\(i^{th}\)` residual, `\(p=\)`number of explanatory variables, and MSE is the mean squared error of the linear model.

Values greater than `\(4/n\)` are large, by a rule of thumb. Or alternatively, greater than 1 is another rule of thumb.

---
# Cooks D for Olympic medal tally

`$$~~~~~~~~~ Raw ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Transformed$$`



```
#&gt;                       Country .cooksd                    Country .cooksd
#&gt; 1                UnitedStates 7.3e+00                    Vietnam 4.6e-02
#&gt; 2                  RussianFed 3.1e+00                 IvoryCoast 4.6e-02
#&gt; 3                       China 1.3e+00 IndependentOlympicAthletes 4.6e-02
#&gt; 4                GreatBritain 9.5e-02                     Israel 4.6e-02
#&gt; 5                      France 6.5e-02               UnitedStates 3.3e-02
#&gt; 6                     Ukraine 2.4e-02                     Latvia 3.3e-02
#&gt; 7                       Japan 2.0e-02              Rep.ofMoldova 3.3e-02
#&gt; 8                  Uzbekistan 2.0e-02                     Uganda 2.2e-02
#&gt; 9                  SouthKorea 1.8e-02                   Botswana 2.2e-02
#&gt; 10                 Azerbaijan 1.6e-02                     Cyprus 2.2e-02
#&gt; 11                  Australia 1.5e-02                      Gabon 2.2e-02
#&gt; 12                    Denmark 8.6e-03                  Guatemala 2.2e-02
#&gt; 13                 NewZealand 6.7e-03                 Montenegro 2.2e-02
#&gt; 14                    Romania 6.6e-03                Afghanistan 2.2e-02
#&gt; 15                     Canada 5.9e-03              HongKongChina 2.2e-02
#&gt; 16                      India 4.9e-03                SaudiArabia 2.2e-02
#&gt; 17                 Kazakhstan 4.4e-03                     Kuwait 2.2e-02
#&gt; 18                       Iran 4.0e-03                 Uzbekistan 1.8e-02
#&gt; 19                    Croatia 3.5e-03             TrinidadTobago 1.8e-02
#&gt; 20                SouthAfrica 3.5e-03                      India 1.5e-02
#&gt; 21                     Greece 3.5e-03                       Fiji 1.3e-02
#&gt; 22                     Serbia 3.5e-03                     Jordan 1.3e-02
#&gt; 23             TrinidadTobago 3.3e-03                     Kosovo 1.3e-02
#&gt; 24                    Ireland 3.1e-03                    Burundi 1.3e-02
#&gt; 25                   Mongolia 3.1e-03                      Niger 1.3e-02
#&gt; 26                    Belarus 2.2e-03                Philippines 1.3e-02
#&gt; 27                       Cuba 2.1e-03                    Austria 1.3e-02
#&gt; 28                     Latvia 2.0e-03                    Nigeria 1.3e-02
#&gt; 29              Rep.ofMoldova 2.0e-03         UnitedArabEmirates 1.3e-02
#&gt; 30                     Sweden 2.0e-03                     Greece 1.3e-02
#&gt; 31                    Finland 1.8e-03                    Finland 1.1e-02
#&gt; 32                     Turkey 1.8e-03                    Romania 1.1e-02
#&gt; 33                Switzerland 1.8e-03                     France 1.1e-02
#&gt; 34                    Belgium 1.7e-03                    Ireland 1.0e-02
#&gt; 35                   Thailand 1.7e-03                   Mongolia 1.0e-02
#&gt; 36                   Malaysia 1.7e-03                    Ukraine 9.9e-03
#&gt; 37                     Brazil 1.6e-03                 Azerbaijan 9.7e-03
#&gt; 38                     Mexico 1.3e-03                  Venezuela 9.6e-03
#&gt; 39                      Kenya 9.9e-04               GreatBritain 9.0e-03
#&gt; 40                     Uganda 8.5e-04                   Malaysia 8.1e-03
#&gt; 41                   Botswana 8.5e-04                    Denmark 6.5e-03
#&gt; 42                     Cyprus 8.5e-04                 PuertoRico 5.9e-03
#&gt; 43                      Gabon 8.5e-04                  Singapore 5.9e-03
#&gt; 44                  Guatemala 8.5e-04                      Qatar 5.9e-03
#&gt; 45                 Montenegro 8.5e-04              DominicanRep. 5.9e-03
#&gt; 46                Afghanistan 8.5e-04                    Estonia 5.9e-03
#&gt; 47              HongKongChina 8.5e-04                     Serbia 5.6e-03
#&gt; 48                SaudiArabia 8.5e-04                      Japan 5.4e-03
#&gt; 49                     Kuwait 8.5e-04                 NewZealand 4.8e-03
#&gt; 50                    Hungary 7.7e-04                    Belgium 4.8e-03
#&gt; 51                 PuertoRico 7.6e-04                   Thailand 4.8e-03
#&gt; 52                  Singapore 7.6e-04                    Croatia 4.1e-03
#&gt; 53                      Qatar 7.6e-04                SouthAfrica 4.1e-03
#&gt; 54              DominicanRep. 7.6e-04                     Canada 3.9e-03
#&gt; 55                    Estonia 7.6e-04                 Kazakhstan 3.5e-03
#&gt; 56                      Italy 5.9e-04                Switzerland 3.5e-03
#&gt; 57                  Venezuela 5.6e-04                       Iran 3.0e-03
#&gt; 58                    Vietnam 5.3e-04                     Turkey 2.8e-03
#&gt; 59                 IvoryCoast 5.3e-04                 RussianFed 2.6e-03
#&gt; 60 IndependentOlympicAthletes 5.3e-04                     Sweden 2.3e-03
#&gt; 61                     Israel 5.3e-04                    Bahrain 2.2e-03
#&gt; 62                  Lithuania 5.3e-04                    Bahamas 2.2e-03
#&gt; 63                    Jamaica 2.3e-04                    Algeria 2.2e-03
#&gt; 64                     Poland 2.1e-04                    Germany 2.1e-03
#&gt; 65                   Ethiopia 1.4e-04                     Brazil 1.7e-03
#&gt; 66                 Tajikistan 1.3e-04                     Mexico 1.7e-03
#&gt; 67                    Grenada 1.3e-04                      Italy 1.4e-03
#&gt; 68                    Morocco 1.3e-04                    Belarus 1.3e-03
#&gt; 69                   Portugal 1.3e-04                      Kenya 1.3e-03
#&gt; 70                 NorthKorea 1.2e-04                 SouthKorea 1.1e-03
#&gt; 71                    Tunisia 8.0e-05                  Lithuania 8.2e-04
#&gt; 72                Netherlands 6.4e-05                  Indonesia 8.2e-04
#&gt; 73                    Armenia 6.4e-05              ChineseTaipei 8.2e-04
#&gt; 74                  Argentina 6.0e-05                   Bulgaria 8.2e-04
#&gt; 75                   Slovakia 6.0e-05                      Egypt 8.2e-04
#&gt; 76                   Slovenia 6.0e-05                       Cuba 7.9e-04
#&gt; 77                     Norway 6.0e-05                 Tajikistan 6.5e-04
#&gt; 78                  Indonesia 4.9e-05                    Grenada 6.5e-04
#&gt; 79              ChineseTaipei 4.9e-05                    Morocco 6.5e-04
#&gt; 80                   Bulgaria 4.9e-05                   Portugal 6.5e-04
#&gt; 81                      Egypt 4.9e-05                    Armenia 4.8e-04
#&gt; 82                      Spain 3.9e-05                     Poland 4.7e-04
#&gt; 83                    Bahrain 3.7e-05                      Spain 3.9e-04
#&gt; 84                    Bahamas 3.7e-05                   Ethiopia 3.5e-04
#&gt; 85                    Algeria 3.7e-05                 NorthKorea 3.3e-04
#&gt; 86                       Fiji 2.5e-05                      China 2.9e-04
#&gt; 87                     Jordan 2.5e-05                Netherlands 2.0e-04
#&gt; 88                     Kosovo 2.5e-05                    Tunisia 9.1e-05
#&gt; 89                    Burundi 2.5e-05              CzechRepublic 4.9e-05
#&gt; 90                      Niger 2.5e-05                  Argentina 3.6e-05
#&gt; 91                Philippines 2.5e-05                   Slovakia 3.6e-05
#&gt; 92                    Austria 2.5e-05                   Slovenia 3.6e-05
#&gt; 93                    Nigeria 2.5e-05                     Norway 3.6e-05
#&gt; 94         UnitedArabEmirates 2.5e-05                    Hungary 2.1e-05
#&gt; 95                    Georgia 1.9e-05                    Jamaica 1.3e-05
#&gt; 96                    Germany 1.2e-05                  Australia 1.0e-05
#&gt; 97                   Colombia 1.1e-05                   Colombia 9.8e-06
#&gt; 98              CzechRepublic 1.6e-06                    Georgia 1.2e-06
```

---

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;

---
# Cooks D for simulated data

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;

Values are more spread, when the one extreme value is removed. No other points are influential.

---
# Solutions

- Remove influential observations, and re-fit model
- Transform explanatory variables to reduce influence
- Use weighted regression to downweight influence of extreme observations

---
class: inverse middle 
# Your turn

- What happens when there are two extreme points with virtually the same values?

---
# Collinearity

Population and GDP are standardised.


```
#&gt;             term estimate std.error statistic p.value
#&gt; 1    (Intercept)   1.8604   0.49070       3.8 2.9e-04
#&gt; 2     Total_2012   0.7471   0.04108      18.2 1.6e-30
#&gt; 3 Population_mil  -0.0260   0.00384      -6.8 1.7e-09
#&gt; 4    GDP_PPP_bil   0.0024   0.00038       6.4 8.4e-09
```

Giving the model `\(M2016=\)` 1.86 `\(+\)` 0.75 `\(M2012+\)` -0.03 `\(Pop+\)` 0 `\(GDP+\varepsilon\)` 

---
# Plot the explanatory variables

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

---
# Explore countries

<div id="f3052791f058" style="width:504px;height:396px;" class="plotly html-widget"></div>
<script type="application/json" data-for="f3052791f058">{"x":{"data":[{"x":[321.4,64.1,1367.5,142.4,80.9,126.9,66.6,49.1,61.9,22.8,16.9,9.9,204.3,48.1,45.9,3,4.5,11,4.4,35.1,29.2,18.2,46.7,8.1,81.8,10.8,43.4,5.6,9.8,53.7,44.4,7.2,38.6,25,11.3,68,5.4,4.9,9.8,9.6,79.4,3.1,10.6,99.5,2,256,21.7,1.3,94.3,23.4,0.3,23.3,null,0.9,8.1,1.9,3.6,5.7,8.2,30.5,121.7,39.5,4.9,2.9,7.2,29.3,1251.7,3,10.7,0.1,18,101,2.2,5.2,88.5,11,8,8.7,10.5,1.3,5.5,33.3,3.5,181.6,10.8,1.2,5.8,null,null,null,null,null,null,null,null,null,null,null,null],"y":[104,65,88,82,44,38,34,28,28,35,20,17,17,17,11,12,6,14,13,18,4,13,8,4,12,2,4,9,8,6,20,4,10,6,3,3,4,7,10,12,5,3,10,7,4,2,9,1,0,2,1,0,0,0,0,0,2,2,1,2,7,1,5,5,2,1,6,5,0,1,0,0,2,4,2,3,0,0,2,2,3,1,0,0,1,4,0,2,1,1,1,1,1,1,2,1,1,1,1],"text":["Population_mil:  321.4<br />Total_2012: 104<br />Country: UnitedStates","Population_mil:   64.1<br />Total_2012:  65<br />Country: GreatBritain","Population_mil: 1367.5<br />Total_2012:  88<br />Country: China","Population_mil:  142.4<br />Total_2012:  82<br />Country: RussianFed","Population_mil:   80.9<br />Total_2012:  44<br />Country: Germany","Population_mil:  126.9<br />Total_2012:  38<br />Country: Japan","Population_mil:   66.6<br />Total_2012:  34<br />Country: France","Population_mil:   49.1<br />Total_2012:  28<br />Country: SouthKorea","Population_mil:   61.9<br />Total_2012:  28<br />Country: Italy","Population_mil:   22.8<br />Total_2012:  35<br />Country: Australia","Population_mil:   16.9<br />Total_2012:  20<br />Country: Netherlands","Population_mil:    9.9<br />Total_2012:  17<br />Country: Hungary","Population_mil:  204.3<br />Total_2012:  17<br />Country: Brazil","Population_mil:   48.1<br />Total_2012:  17<br />Country: Spain","Population_mil:   45.9<br />Total_2012:  11<br />Country: Kenya","Population_mil:    3.0<br />Total_2012:  12<br />Country: Jamaica","Population_mil:    4.5<br />Total_2012:   6<br />Country: Croatia","Population_mil:   11.0<br />Total_2012:  14<br />Country: Cuba","Population_mil:    4.4<br />Total_2012:  13<br />Country: NewZealand","Population_mil:   35.1<br />Total_2012:  18<br />Country: Canada","Population_mil:   29.2<br />Total_2012:   4<br />Country: Uzbekistan","Population_mil:   18.2<br />Total_2012:  13<br />Country: Kazakhstan","Population_mil:   46.7<br />Total_2012:   8<br />Country: Colombia","Population_mil:    8.1<br />Total_2012:   4<br />Country: Switzerland","Population_mil:   81.8<br />Total_2012:  12<br />Country: Iran","Population_mil:   10.8<br />Total_2012:   2<br />Country: Greece","Population_mil:   43.4<br />Total_2012:   4<br />Country: Argentina","Population_mil:    5.6<br />Total_2012:   9<br />Country: Denmark","Population_mil:    9.8<br />Total_2012:   8<br />Country: Sweden","Population_mil:   53.7<br />Total_2012:   6<br />Country: SouthAfrica","Population_mil:   44.4<br />Total_2012:  20<br />Country: Ukraine","Population_mil:    7.2<br />Total_2012:   4<br />Country: Serbia","Population_mil:   38.6<br />Total_2012:  10<br />Country: Poland","Population_mil:   25.0<br />Total_2012:   6<br />Country: NorthKorea","Population_mil:   11.3<br />Total_2012:   3<br />Country: Belgium","Population_mil:   68.0<br />Total_2012:   3<br />Country: Thailand","Population_mil:    5.4<br />Total_2012:   4<br />Country: Slovakia","Population_mil:    4.9<br />Total_2012:   7<br />Country: Georgia","Population_mil:    9.8<br />Total_2012:  10<br />Country: Azerbaijan","Population_mil:    9.6<br />Total_2012:  12<br />Country: Belarus","Population_mil:   79.4<br />Total_2012:   5<br />Country: Turkey","Population_mil:    3.1<br />Total_2012:   3<br />Country: Armenia","Population_mil:   10.6<br />Total_2012:  10<br />Country: CzechRepublic","Population_mil:   99.5<br />Total_2012:   7<br />Country: Ethiopia","Population_mil:    2.0<br />Total_2012:   4<br />Country: Slovenia","Population_mil:  256.0<br />Total_2012:   2<br />Country: Indonesia","Population_mil:   21.7<br />Total_2012:   9<br />Country: Romania","Population_mil:    1.3<br />Total_2012:   1<br />Country: Bahrain","Population_mil:   94.3<br />Total_2012:   0<br />Country: Vietnam","Population_mil:   23.4<br />Total_2012:   2<br />Country: ChineseTaipei","Population_mil:    0.3<br />Total_2012:   1<br />Country: Bahamas","Population_mil:   23.3<br />Total_2012:   0<br />Country: IvoryCoast","Population_mil:     NA<br />Total_2012:   0<br />Country: Independent","Population_mil:    0.9<br />Total_2012:   0<br />Country: Fiji","Population_mil:    8.1<br />Total_2012:   0<br />Country: Jordan","Population_mil:    1.9<br />Total_2012:   0<br />Country: Kosovo","Population_mil:    3.6<br />Total_2012:   2<br />Country: PuertoRico","Population_mil:    5.7<br />Total_2012:   2<br />Country: Singapore","Population_mil:    8.2<br />Total_2012:   1<br />Country: Tajikistan","Population_mil:   30.5<br />Total_2012:   2<br />Country: Malaysia","Population_mil:  121.7<br />Total_2012:   7<br />Country: Mexico","Population_mil:   39.5<br />Total_2012:   1<br />Country: Algeria","Population_mil:    4.9<br />Total_2012:   5<br />Country: Ireland","Population_mil:    2.9<br />Total_2012:   5<br />Country: Lithuania","Population_mil:    7.2<br />Total_2012:   2<br />Country: Bulgaria","Population_mil:   29.3<br />Total_2012:   1<br />Country: Venezuela","Population_mil: 1251.7<br />Total_2012:   6<br />Country: India","Population_mil:    3.0<br />Total_2012:   5<br />Country: Mongolia","Population_mil:   10.7<br />Total_2012:   0<br />Country: Burundi","Population_mil:    0.1<br />Total_2012:   1<br />Country: Grenada","Population_mil:   18.0<br />Total_2012:   0<br />Country: Niger","Population_mil:  101.0<br />Total_2012:   0<br />Country: Philippines","Population_mil:    2.2<br />Total_2012:   2<br />Country: Qatar","Population_mil:    5.2<br />Total_2012:   4<br />Country: Norway","Population_mil:   88.5<br />Total_2012:   2<br />Country: Egypt","Population_mil:   11.0<br />Total_2012:   3<br />Country: Tunisia","Population_mil:    8.0<br />Total_2012:   0<br />Country: Israel","Population_mil:    8.7<br />Total_2012:   0<br />Country: Austria","Population_mil:   10.5<br />Total_2012:   2<br />Country: DominicanRep.","Population_mil:    1.3<br />Total_2012:   2<br />Country: Estonia","Population_mil:    5.5<br />Total_2012:   3<br />Country: Finland","Population_mil:   33.3<br />Total_2012:   1<br />Country: Morocco","Population_mil:    3.5<br />Total_2012:   0<br />Country: Moldova","Population_mil:  181.6<br />Total_2012:   0<br />Country: Nigeria","Population_mil:   10.8<br />Total_2012:   1<br />Country: Portugal","Population_mil:    1.2<br />Total_2012:   4<br />Country: TrinidadTobago","Population_mil:    5.8<br />Total_2012:   0<br />Country: U.A.E.","Population_mil:     NA<br />Total_2012:   2<br />Country: Latvia","Population_mil:     NA<br />Total_2012:   1<br />Country: Uganda","Population_mil:     NA<br />Total_2012:   1<br />Country: Botswana","Population_mil:     NA<br />Total_2012:   1<br />Country: Cyprus","Population_mil:     NA<br />Total_2012:   1<br />Country: Gabon","Population_mil:     NA<br />Total_2012:   1<br />Country: Guatemala","Population_mil:     NA<br />Total_2012:   1<br />Country: Montenegro","Population_mil:     NA<br />Total_2012:   2<br />Country: Rep.ofMoldova","Population_mil:     NA<br />Total_2012:   1<br />Country: Afghanistan","Population_mil:     NA<br />Total_2012:   1<br />Country: HongKongChina","Population_mil:     NA<br />Total_2012:   1<br />Country: SaudiArabia","Population_mil:     NA<br />Total_2012:   1<br />Country: Kuwait"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.2984640929846,"r":7.30593607305936,"b":39.252801992528,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-68.27,1435.87],"ticktext":["0","500","1000"],"tickvals":[0,500,1000],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Population_mil","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-5.2,109.2],"ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Total_2012","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"f3051f6af74d":{"x":{},"y":{},"label":{},"type":"ggplotly"}},"cur_data":"f3051f6af74d","visdat":{"f3051f6af74d":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>

---
# Variance inflation factor (VIF)

`$$\frac{1}{1-R_j^2}$$`

where `\(R_j^2\)` is computed by regressing variable `\(j\)` on all other variables. VIF is a measure the collinearity of the explanatory variables. Values greater than 10 are considered to be high. 

These are the VIFs for the olympic medal tally data:


```
#&gt;     Total_2012 Population_mil    GDP_PPP_bil 
#&gt;            3.6            3.5            7.6
```

---
# Suppose we add 2008 counts as an explanatory variable

&lt;img src="week5.class1_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;

---
# Model


```
#&gt;             term estimate std.error statistic p.value
#&gt; 1    (Intercept)   2.2413   0.57642       3.9 2.3e-04
#&gt; 2     Total_2012   0.9080   0.10146       8.9 3.7e-13
#&gt; 3     Total_2008  -0.2025   0.10785      -1.9 6.5e-02
#&gt; 4 Population_mil  -0.0278   0.00410      -6.8 3.3e-09
#&gt; 5    GDP_PPP_bil   0.0028   0.00043       6.5 1.1e-08
```

Giving the model `\(M2016=\)` 2.24 `\(+\)` 0.91 `\(2012+\)` -0.2 `\(M2008+\)` -0.03 `\(Pop+\)` 0 `\(GDP+\varepsilon\)` 

---
# VIFs



Notice that the VIFs for both 2008 and 2012 are high. 

---
class: inverse middle 
# Your turn

- Why is it called `Variance Inflation Factor`? Look at the standard deviation of the estimates for the model with 2012 and without 2004.  
- Why would multicollinearity inflate variance of estimates?

---
# Solutions

- Drop some variables
- Use principal component regression (more advanced courses)
- Partial regression: Fit best variable. Regress next explanatory variable first variable and use the residuals from this fit as the second variable in the model. Continue with other variables. 

---
# Resources

- [Regression Diagnostics: Identifying Influential Data and Sources of Collinearity](http://onlinelibrary.wiley.com/book/10.1002/0471725153)

---
class: inverse middle 
# Share and share alike

&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;This work is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;Creative Commons Attribution 4.0 International License&lt;/a&gt;.
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>

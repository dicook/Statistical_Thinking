test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result,
levels=c("PI","S","SA","SP","VB"))
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
levels(test_sub)
levels(test_sub$result)
levels(test_sub$property_type)
levels(test_sub$suburb)
unlink('lab8_cache', recursive = TRUE)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type)
library(caret)
set.seed(2420)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result,
levels=c("PI","S","SA","SP","VB"))
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type)
library(caret)
set.seed(5242)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result,
levels=c("PI","S","SA","SP","VB"))
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type)
library(caret)
set.seed(2)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result,
levels=c("PI","S","SA","SP","VB"))
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type)
library(caret)
set.seed(21)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result,
levels=c("PI","S","SA","SP","VB"))
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
table(train$result)
table(test$result)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type) %>%
filter(result != "SA")
library(caret)
set.seed(21)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result)
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type) %>%
filter(result != "SA")
library(caret)
set.seed(24205242)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result)
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type) %>%
filter(result != "SA")
library(caret)
set.seed(2420)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result)
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type) %>%
filter(result != "SA")
library(caret)
set.seed(242)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result)
test_sub$property_type <- factor(test_sub$property_type)
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train_sub)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test_sub)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
error = FALSE,
echo = FALSE,
collapse = TRUE,
comment = "#",
fig.height = 4,
fig.width = 8,
fig.align = "center",
cache = FALSE
)
library(knitr)
library(tidyverse)
melb_auctions <- read_csv("melb_auctions.csv")
summary(melb_auctions)
ggplot(melb_auctions, aes(x=factor(year), y=price)) +
geom_boxplot() +
facet_grid(property_type~suburb)
melb_auctions <- melb_auctions %>%
select(price, suburb, result, nbeds, property_type) %>%
filter(result != "SA")
library(caret)
set.seed(242)
indx <- createDataPartition(melb_auctions$suburb, list=FALSE)
train <- melb_auctions[indx,]
test <- melb_auctions[-indx,]
MSE <- function(model, data) {
pred <- predict(model, data)
e <- data$price - pred
mse <- sum(e^2)/length(e)
return(mse)
}
library(rpart)
train_rp <- rpart(price~suburb+result+nbeds+property_type,
data=train)
library(rpart.plot)
rpart.plot(train_rp)
MSE(train_rp, test)
cp <- seq(0.001, 0.1, 0.001)
m <- NULL
for (i in 1:length(cp)) {
train_rp <- rpart(price~suburb+result+nbeds+property_type, data=train,
control=rpart.control(cp=cp[i]))
m <- c(m, MSE(train_rp, test))
}
df <- data.frame(cp, m)
ggplot(df, aes(x=cp, y=m)) + geom_line()
train_glm <- glm(price~suburb+result+nbeds+property_type, data=train)
train_glm
summary(train_glm)$coefficients
MSE(train_glm, test)
# randomForest function crashes if character variables are not factors
train_sub <- train
train_sub$suburb <- factor(train_sub$suburb)
train_sub$result <- factor(train_sub$result)
train_sub$property_type <- factor(train_sub$property_type)
test_sub <- test
test_sub$suburb <- factor(test_sub$suburb)
test_sub$result <- factor(test_sub$result)
test_sub$property_type <- factor(test_sub$property_type)
library(randomForest)
train_rf <- randomForest(price~suburb+result+nbeds+property_type,
data=train_sub, importance=TRUE)
train_rf
train_rf$importance
MSE(train_rf, test_sub)
train_rf <- randomForest(price~suburb+result+nbeds+property_type,
data=train_sub, importance=TRUE, mtry=3)
train_rf
MSE(train_rf, test_sub)
train_rf <- randomForest(price~suburb+result+nbeds+property_type,
data=train_sub, importance=TRUE, mtry=3, ntree=1000)
train_rf
MSE(train_rf, test_sub)
pred1 <- predict(train_rp, test)
pred2 <- predict(train_glm, test)
pred3 <- predict(train_rf, test_sub)
df <- data.frame(pred1, pred2, pred3)
p1 <- ggplot(df, aes(x=pred1, y=pred2)) +
geom_point() + theme(aspect.ratio=1) +
xlab("Tree") + ylab("glm")
p2 <- ggplot(df, aes(x=pred1, y=pred3)) +
geom_point() + theme(aspect.ratio=1) +
xlab("Tree") + ylab("Forest")
p3 <- ggplot(df, aes(x=pred2, y=pred3)) +
geom_point() + theme(aspect.ratio=1) +
xlab("glm") + ylab("Forest")
library(gridExtra)
grid.arrange(p1, p2, p3, ncol=3)
?redict.rp
?predict.rpart
pred1 <- predict(train_rp, test, type="vector")
pred2 <- predict(train_glm, test)
pred3 <- predict(train_rf, test_sub)
df <- data.frame(pred1, pred2, pred3)
p1 <- ggplot(df, aes(x=pred1, y=pred2)) +
geom_point() + theme(aspect.ratio=1) +
xlab("Tree") + ylab("glm")
p2 <- ggplot(df, aes(x=pred1, y=pred3)) +
geom_point() + theme(aspect.ratio=1) +
xlab("Tree") + ylab("Forest")
p3 <- ggplot(df, aes(x=pred2, y=pred3)) +
geom_point() + theme(aspect.ratio=1) +
xlab("glm") + ylab("Forest")
library(gridExtra)
grid.arrange(p1, p2, p3, ncol=3)

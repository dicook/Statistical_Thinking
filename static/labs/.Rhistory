getwd()
install.packages("CASdatasets")
install.packages("CASdatasets", repos = "http://cas.uqam.ca/pub/R/")
install.packages("xts")
install.packages("sp")
install.packages("CASdatasets", repos = "http://cas.uqam.ca/pub/R/")
library(CASdatasets)
data(usworkcomp)
help(usworkcomp)
library(ggplot2)
ggplot(usworkcomp, aes(x=LOSS)) + geom_histogram()
save(usworkcomp, file="usworkcomp.rda")
load("usworkcomp.rda")
library(ggplot2)
library(gridExtra)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
ggplot(df_30, aes(x=x1)) + geom_histogram()
ggplot(df_30, aes(x=x2)) + geom_histogram()
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
ggplot(df_100, aes(x=x1)) + geom_histogram()
ggplot(df_100, aes(x=x2)) + geom_histogram()
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
ggplot(df_500, aes(x=x1)) + geom_histogram()
ggplot(df_500, aes(x=x2)) + geom_histogram()
?qqplot
library(ggplot2)
library(gridExtra)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
p1 <- ggplot(df_30, aes(x=x1)) + geom_histogram() + ggtitle("n=30, lognorm")
p2 <- ggplot(df_30, aes(x=x2)) + geom_histogram() + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
p3 <- ggplot(df_100, aes(x=x1)) + geom_histogram() + ggtitle("n=30, lognorm")
p4 <- ggplot(df_100, aes(x=x2)) + geom_histogram() + ggtitle("n=30, gamma")
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
p5 <- ggplot(df_500, aes(x=x1)) + geom_histogram() + ggtitle("n=30, lognorm")
p6 <- ggplot(df_500, aes(x=x2)) + geom_histogram() + ggtitle("n=30, gamma")
grid.arrange(p1, p3, p5, p2, p4, p6, ncol=3)
library(ggplot2)
library(gridExtra)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
p1 <- ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
p2 <- ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.5) + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
p3 <- ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
p4 <- ggplot(df_100, aes(x=x2)) + geom_histogram(binwidth=0.5) + ggtitle("n=30, gamma")
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
p5 <- ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
p6 <- ggplot(df_500, aes(x=x2)) + geom_histogram(binwidth=0.5) + ggtitle("n=30, gamma")
grid.arrange(p1, p3, p5, p2, p4, p6, ncol=3)
ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.5) + ggtitle("n=30, gamma")
ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=100, lognorm")
ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=1000) + ggtitle("n=100, lognorm")
ggplot(df_100, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=100, gamma")
ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=500, lognorm")
ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=2500) + ggtitle("n=500, lognorm")
ggplot(df_500, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=500, gamma")
library(ggplot2)
library(gridExtra)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
p1 <- ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
p2 <- ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
p3 <- ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=1000) + ggtitle("n=100, lognorm")
p4 <- ggplot(df_100, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=100, gamma")
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
p5 <- ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=2500) + ggtitle("n=500, lognorm")
p6 <- ggplot(df_500, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=500, gamma")
grid.arrange(p1, p3, p5, p2, p4, p6, ncol=3)
library(ggplot2)
library(gridExtra)
set.seed(555)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
p1 <- ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=500) + ggtitle("n=30, lognorm")
p2 <- ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
p3 <- ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=500) + ggtitle("n=100, lognorm")
p4 <- ggplot(df_100, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=100, gamma")
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
p5 <- ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=500) + ggtitle("n=500, lognorm")
p6 <- ggplot(df_500, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=500, gamma")
grid.arrange(p1, p3, p5, p2, p4, p6, ncol=3)
library(ggplot2)
library(gridExtra)
set.seed(4)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
p1 <- ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
p2 <- ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
p3 <- ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=500) + ggtitle("n=100, lognorm")
p4 <- ggplot(df_100, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=100, gamma")
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
p5 <- ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=500) + ggtitle("n=500, lognorm")
p6 <- ggplot(df_500, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=500, gamma")
grid.arrange(p1, p3, p5, p2, p4, p6, ncol=3)
library(ggplot2)
library(gridExtra)
set.seed(4)
df_30 <- data.frame(x1=rlnorm(30, 4, 2), x2=rgamma(30, 3, 3))
p1 <- ggplot(df_30, aes(x=x1)) + geom_histogram(binwidth=250) + ggtitle("n=30, lognorm")
p2 <- ggplot(df_30, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=30, gamma")
df_100 <- data.frame(x1=rlnorm(100, 4, 2), x2=rgamma(100, 3, 3))
p3 <- ggplot(df_100, aes(x=x1)) + geom_histogram(binwidth=2500) + ggtitle("n=100, lognorm")
p4 <- ggplot(df_100, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=100, gamma")
df_500 <- data.frame(x1=rlnorm(500, 4, 2), x2=rgamma(500, 3, 3))
p5 <- ggplot(df_500, aes(x=x1)) + geom_histogram(binwidth=2500) + ggtitle("n=500, lognorm")
p6 <- ggplot(df_500, aes(x=x2)) + geom_histogram(binwidth=0.25) + ggtitle("n=500, gamma")
grid.arrange(p1, p3, p5, p2, p4, p6, ncol=3)
n <- 30
df_30$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 2, 0.5)
df_30$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 2, 4)
p1 <- ggplot(df_30, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal()
p2 <- ggplot(df_30, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal()
grid.arrange(p1, p2, ncol=2)
df_30$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_30$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
p1 <- ggplot(df_30, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal()
p2 <- ggplot(df_30, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal()
grid.arrange(p1, p2, ncol=2)
n <- 30
df_30$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_30$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
p1 <- ggplot(df_30, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_30, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3")
grid.arrange(p1, p2, ncol=2)
n <- 100
df_100$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_100$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
p1 <- ggplot(df_100, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_100, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3)")
grid.arrange(p1, p2, ncol=2)
n <- 500
df_500$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_500$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
p1 <- ggplot(df_500, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_500, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3)")
grid.arrange(p1, p2, ncol=2)
pnorm(1.3, 3.3, 1.1)
?pnorm
pnorm(1.3, 3.3, 1.1)
1-pnorm(1.9, 3.3, 1.1)
pnorm(2.2, 3.3, 1.1)-pnorm(1.8, 3.3, 1.1)
qnorm(0.53, -10, 4)
qnorm(0.12, -10, 4)
qnorm(0.84, -10, 4)
qnorm(1.2, -10, 4)
dnorm(13, 12, 5)
dnorm(4, 12, 5)
dnorm(20, 12, 5)
df <- as_tibble(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
library(tidyverse)
df <- as_tibble(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
summary(df)
df <- as_tibble(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
?as_tibble
df <- as.data.frame(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
df <- as.data.frame(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
df <- data.frame(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
df <- df %>% gather(d1:d3)
df <- data.frame(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
df <- df %>% gather(dist, density, d1:d3)
ggplot(df, aes(x=x, y=density, colout=dist)) + geom_line()
ggplot(df, aes(x=x, y=density, colour=dist)) + geom_line()
df <- data.frame(x=seq(0, 10, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
df <- df %>% gather(dist, density, d1:d3) %>%
mutate(dist=factor(dist, levels=c("d1", "d2", "d3"),
labels=c("Weibull(3, 1.5)", "Weibull(2, 2)", "Weibull(1,1)")))
ggplot(df, aes(x=x, y=density, colour=dist)) + geom_line()
df <- data.frame(x=seq(0, 5, 0.1),
d1=dweibull(seq(0, 10, 0.1), 3, 1.5),
d2=dweibull(seq(0, 10, 0.1), 2, 2),
d3=dweibull(seq(0, 10, 0.1), 1, 1))
df <- data.frame(x=seq(0, 5, 0.1),
d1=dweibull(seq(0, 5, 0.1), 3, 1.5),
d2=dweibull(seq(0, 5, 0.1), 2, 2),
d3=dweibull(seq(0, 5, 0.1), 1, 1))
df <- df %>% gather(dist, density, d1:d3) %>%
mutate(dist=factor(dist, levels=c("d1", "d2", "d3"),
labels=c("Weibull(3, 1.5)", "Weibull(2, 2)", "Weibull(1,1)")))
ggplot(df, aes(x=x, y=density, colour=dist)) + geom_line()
p1 <- ggplot(df_100, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims1) + ylim(lims1) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
lims1 <- c(min(min(df_100$x1), min(df_100$x1q)), max(max(df_100$x1), max(df_100$x1q)))
lims2 <- c(min(min(df_100$x2), min(df_100$x2q)), max(max(df_100$x2), max(df_100$x2q)))
p1 <- ggplot(df_100, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims1) + ylim(lims1) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_100, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims2) + ylim(lims2) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3)")
grid.arrange(p1, p2, ncol=2)
?coord_equal
n <- 30
df_30$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_30$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
lims1 <- c(min(min(df_30$x1), min(df_30$x1q)), max(max(df_30$x1), max(df_30$x1q)))
lims2 <- c(min(min(df_30$x2), min(df_30$x2q)), max(max(df_30$x2), max(df_30$x2q)))
p1 <- ggplot(df_30, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims1) + ylim(lims1) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_30, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims2) + ylim(lims2) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3)")
grid.arrange(p1, p2, ncol=2)
n <- 100
df_100$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_100$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
lims1 <- c(min(min(df_100$x1), min(df_100$x1q)), max(max(df_100$x1), max(df_100$x1q)))
lims2 <- c(min(min(df_100$x2), min(df_100$x2q)), max(max(df_100$x2), max(df_100$x2q)))
p1 <- ggplot(df_100, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims1) + ylim(lims1) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_100, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims2) + ylim(lims2) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3)")
grid.arrange(p1, p2, ncol=2)
n <- 500
df_500$x1q = qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 4, 2)
df_500$x2q = qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 3, 3)
lims1 <- c(min(min(df_500$x1), min(df_500$x1q)), max(max(df_500$x1), max(df_500$x1q)))
lims2 <- c(min(min(df_500$x2), min(df_500$x2q)), max(max(df_500$x2), max(df_500$x2q)))
p1 <- ggplot(df_500, aes(x=sort(x1), y=x1q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims1) + ylim(lims1) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("lognormal(2,4)")
p2 <- ggplot(df_500, aes(x=sort(x2), y=x2q)) +
geom_abline(intercept=0, slope=1) +
geom_point() + coord_equal() +
xlim(lims2) + ylim(lims2) +
xlab("Sample quantiles") + ylab("Theoretical quantiles") +
ggtitle("gamma(3,3)")
grid.arrange(p1, p2, ncol=2)
X2 <- data.frame(x=rgamma(n=544, 3.2, 1.7))
set.seed(123)
X2 <- data.frame(x=rgamma(n=544, 3.2, 1.7))
ggplot(data.frame(X2), aes(x=X2)) + geom_histogram(binwidth=2)
ggplot(data.frame(X2), aes(x=X2)) + geom_histogram(binwidth=1)
a <- seq(1.0, 4.5, 0.1)
b <- seq(0.5, 3.4, 0.1)
g <- expand.grid(x=a, y=b)
g$f <- 0
nmle <- function(x, a, b) {
f <- prod(dgamma(x, a, b))
return(f)
}
for (i in 1:nrow(g)) {
g$f[i] <- nmle(X2, g$x[i], g$y[i])
}
g$f <- 0
for (i in 1:nrow(g)) {
g$f[i] <- nmle(X2, g$a[i], g$b[i])
}
a <- seq(1.0, 4.5, 0.1)
b <- seq(0.5, 3.4, 0.1)
g <- expand.grid(x=a, y=b)
head(g)
summary(g)
set.seed(123)
X2 <- data.frame(x=rgamma(n=544, 3.2, 1.7))
summary(X2)
g$f <- 0
for (i in 1:nrow(g)) {
g$f[i] <- nmle(X2, g$x[i], g$y[i])
}
g$f <- 0
for (i in 1:nrow(g)) {
cat(i,"\n")
g$f[i] <- nmle(X2, g$x[i], g$y[i])
}
i=1
nmle(X2, g$x[i], g$y[i])
g$x[i]
g$y[i]
X2
dgamma(X2, g$x[i], g$y[i])
?dgamma
dgamma(X2, 1, 0.5)
dgamma(X2, 1, 1)
dgamma(X2$x, 1, 1)
set.seed(123)
X2 <- rgamma(n=544, 3.2, 1.7)
ggplot(data.frame(X2), aes(x=X2)) + geom_histogram(binwidth=1)
dgamma(X2, 1, 0.5)
a <- seq(1.0, 4.5, 0.1)
b <- seq(0.5, 3.4, 0.1)
g <- expand.grid(x=a, y=b)
g$f <- 0
for (i in 1:nrow(g)) {
cat(i,"\n")
g$f[i] <- nmle(X2, g$x[i], g$y[i])
}
ggplot(g, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(alpha)) + ylab(expression(beta)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
a <- seq(2.5, 4.2, 0.05)
b <- seq(1.5, 2.5, 0.05)
g <- expand.grid(x=a, y=b)
g$f <- 0
for (i in 1:nrow(g)) {
cat(i,"\n")
g$f[i] <- nmle(X2, g$x[i], g$y[i])
}
ggplot(g, aes(x=x, y=y, fill=f)) + geom_tile() + xlab(expression(alpha)) + ylab(expression(beta)) + theme_bw() +
scale_fill_continuous("L") +
theme(aspect.ratio=1)
library(MASS)
fitdistr(X2, "gamma")
g[which.min(g$f),]
g[which.max(g$f),]
ggplot(usworkcomp, aes(x=Loss)) + geom_histogram()
load("usworkcomp.rda")
ggplot(usworkcomp, aes(x=Loss)) + geom_histogram()
ggplot(usworkcomp, aes(x=LOSS)) + geom_histogram()
fitdistr(usworkcomp$LOSS, "gamma")
fitdistr(usworkcomp$LOSS, "lognormal")
summary(usworkcomp$LOSS)
fitdistr(usworkcomp$LOSS+1, "gamma")
fitdistr(usworkcomp$LOSS+100, "gamma")
?fitdistr
library(CASdatasets)
data(danishuni)
summary(danishuni)
summary(usworkcomp$LOSS)
fitdistr((usworkcomp$LOSS+100)/100000, "gamma")
fitdistr((usworkcomp$LOSS+100)/100000, "lognormal")
fitdistr((usworkcomp$LOSS+100)/100000, "gamma")
fitdistr((usworkcomp$LOSS+100)/100000, "lognormal")
n <- nrow(usworkcomp)
df <- data.frame(x1=sort(usworkcomp$LOSS))
df$qg = (qgamma(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 0.367774667, 0.023499352))*100000-100
df$qln = (qlnorm(c(1 - 0.5^(1/n), (2:(n-1) - 0.3175) /
(n + 0.365),0.5^(1/n)), 0.93691677, 2.84185608))*100000-100
p1 <- ggplot(df, aes(x=x1, y=qg)) +
geom_abline(intercept=0, slope=1) +
geom_point() + theme(aspect.ratio=1)
p2 <- ggplot(df, aes(x=x1, y=qln)) +
geom_abline(intercept=0, slope=1) +
geom_point() + theme(aspect.ratio=1)
grid.arrange(p1, p2, ncol=2)
